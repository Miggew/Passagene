import{r as t,s as c}from"./index-B-7HRnm0.js";import{u as q}from"./use-toast-DDUqdzpY.js";function C(){const{toast:e}=q(),[l,s]=t.useState(!1),[g,n]=t.useState([]),[m,i]=t.useState([]),[E,u]=t.useState([]),w=t.useCallback(async()=>{try{s(!0);const{data:a,error:r}=await c.from("vw_catalogo_destaques").select("*").order("ordem").order("publicado_em",{ascending:!1});if(r)throw r;u(a||[])}catch(a){console.error("[useCatalogoData] Erro ao carregar destaques:",a),e({title:"Erro ao carregar destaques",description:a instanceof Error?a.message:"Erro desconhecido",variant:"destructive"})}finally{s(!1)}},[e]),f=t.useCallback(async a=>{try{s(!0);let r=c.from("vw_catalogo_doadoras").select("*").order("destaque",{ascending:!1}).order("ordem").order("publicado_em",{ascending:!1});a!=null&&a.raca&&(r=r.eq("raca",a.raca)),a!=null&&a.busca&&(r=r.or(`nome.ilike.%${a.busca}%,registro.ilike.%${a.busca}%`));const{data:o,error:d}=await r;if(d)throw d;n(o||[])}catch(r){console.error("[useCatalogoData] Erro ao carregar doadoras:",r),e({title:"Erro ao carregar doadoras",description:r instanceof Error?r.message:"Erro desconhecido",variant:"destructive"})}finally{s(!1)}},[e]),h=t.useCallback(async a=>{try{s(!0);let r=c.from("vw_catalogo_touros").select("*").order("destaque",{ascending:!1}).order("ordem").order("publicado_em",{ascending:!1});a!=null&&a.raca&&(r=r.eq("raca",a.raca)),a!=null&&a.busca&&(r=r.or(`nome.ilike.%${a.busca}%,registro.ilike.%${a.busca}%`));const{data:o,error:d}=await r;if(d)throw d;i(o||[])}catch(r){console.error("[useCatalogoData] Erro ao carregar touros:",r),e({title:"Erro ao carregar touros",description:r instanceof Error?r.message:"Erro desconhecido",variant:"destructive"})}finally{s(!1)}},[e]),_=t.useCallback(async a=>{try{const{data:r,error:o}=await c.from("vw_catalogo_doadoras").select("*").eq("catalogo_id",a).single();if(o)throw o;return r}catch(r){return console.error("[useCatalogoData] Erro ao carregar doadora:",r),e({title:"Erro ao carregar doadora",description:r instanceof Error?r.message:"Erro desconhecido",variant:"destructive"}),null}},[e]),v=t.useCallback(async a=>{try{const{data:r,error:o}=await c.from("vw_catalogo_touros").select("*").eq("catalogo_id",a).single();if(o)throw o;return r}catch(r){return console.error("[useCatalogoData] Erro ao carregar touro:",r),e({title:"Erro ao carregar touro",description:r instanceof Error?r.message:"Erro desconhecido",variant:"destructive"}),null}},[e]),y=t.useCallback(async()=>{try{s(!0);const[a,r,o]=await Promise.all([c.from("vw_catalogo_destaques").select("*").order("ordem").limit(8),c.from("vw_catalogo_doadoras").select("*").order("destaque",{ascending:!1}).order("ordem").limit(4),c.from("vw_catalogo_touros").select("*").order("destaque",{ascending:!1}).order("ordem").limit(4)]);if(a.error)throw a.error;if(r.error)throw r.error;if(o.error)throw o.error;u(a.data||[]),n(r.data||[]),i(o.data||[])}catch(a){console.error("[useCatalogoData] Erro ao carregar dados home:",a),e({title:"Erro ao carregar cat√°logo",description:a instanceof Error?a.message:"Erro desconhecido",variant:"destructive"})}finally{s(!1)}},[e]);return{loading:l,doadoras:g,touros:m,destaques:E,loadDestaques:w,loadDoadoras:f,loadTouros:h,loadDoadoraById:_,loadTouroById:v,loadHomeData:y}}export{C as u};
