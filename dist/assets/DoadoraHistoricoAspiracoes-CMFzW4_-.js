import{c as p,r,s as y,j as a,i as N}from"./index-BPMeM9-O.js";import{D as _,b,c as k,d as D}from"./dialog-CLDnxY7R.js";import{C as o,D as M}from"./index-BkgnAyi6.js";import{u as O}from"./use-toast-BGNwDi9e.js";import{f as A}from"./dateUtils-eJ5e6apA.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=p("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=p("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);function P({doadoraId:i,doadoraNome:l,open:c,onClose:m}){const[t,x]=r.useState([]),[u,d]=r.useState(!1),{toast:f}=O();r.useEffect(()=>{c&&i&&h()},[c,i]);const h=async()=>{try{d(!0);const{data:e,error:s}=await y.from("aspiracoes_doadoras").select("*").eq("doadora_id",i).order("data_aspiracao",{ascending:!1});if(s)throw s;x(e||[])}catch(e){f({title:"Erro ao carregar histórico",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{d(!1)}},n=r.useMemo(()=>{const e=t.length,s=t.reduce((g,j)=>g+(j.total_oocitos||0),0),v=e>0?Math.round(s/e):0;return{total:e,totalOocitos:s,mediaOocitos:v}},[t]);return a.jsx(_,{open:c,onOpenChange:m,children:a.jsxs(b,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[a.jsx(k,{className:"pb-2",children:a.jsxs(D,{className:"text-base",children:["Histórico de Aspirações ",l&&`— ${l}`]})}),u?a.jsx("div",{className:"py-8",children:a.jsx(N,{})}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-4 pb-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Total Aspirações:"}),a.jsx(o,{value:n.total,variant:"default"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Total Oócitos:"}),a.jsx(o,{value:n.totalOocitos,variant:"primary"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Média/Aspiração:"}),a.jsx(o,{value:n.mediaOocitos,variant:"info"})]})]}),a.jsx(M,{data:t,rowKey:"id",rowNumber:!0,emptyMessage:"Nenhuma aspiração registrada para esta doadora",columns:[{key:"data_aspiracao",label:"Data"},{key:"total_oocitos",label:"Oócitos",align:"center"},{key:"veterinario_responsavel",label:"Veterinário"},{key:"tecnico_responsavel",label:"Técnico"}],renderCell:(e,s)=>{switch(s.key){case"data_aspiracao":return a.jsx("span",{className:"text-foreground",children:A(e.data_aspiracao)});case"total_oocitos":return a.jsx(o,{value:e.total_oocitos??0,variant:"primary"});case"veterinario_responsavel":return a.jsx("span",{className:"text-xs text-muted-foreground",children:e.veterinario_responsavel||"—"});case"tecnico_responsavel":return a.jsx("span",{className:"text-xs text-muted-foreground",children:e.tecnico_responsavel||"—"});default:return null}}})]})]})})}export{P as D,G,H as P};
