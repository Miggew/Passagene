import{a as S,r as n,s as t,j as e,U as D,D as m,ah as p,m as y,C as R,ai as E}from"./index-BPMeM9-O.js";import{C as r,d as o,a as I,b as z,c as A}from"./card-8azKTSNJ.js";import{u as O}from"./useClienteFilter-CwSUSM41.js";import{P as T}from"./PageHeader-DQ4rM2jO.js";import{A as P}from"./activity-CIWhM6rb.js";import{C as q}from"./calendar-CuUQg-xw.js";import{A as L}from"./arrow-right-CoqNrwoH.js";function $(){const u=S(),{clienteIdFilter:a,userContext:h}=O(),[i,g]=n.useState({protocolos:0,aspiracoes:0,receptoras:0,doadoras:0,embrioes:0,dosesSemen:0}),[c,x]=n.useState(!0);n.useEffect(()=>{j()},[a]);const j=async()=>{try{x(!0);let s=[];if(a){const{data:d}=await t.from("fazendas").select("id").eq("cliente_id",a);s=(d==null?void 0:d.map(C=>C.id))??[]}const[l,b,N,v,w,_]=await Promise.all([a&&s.length>0?t.from("protocolos_sincronizacao").select("id",{count:"exact",head:!0}).in("fazenda_id",s).gte("data_inicio",new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0]):t.from("protocolos_sincronizacao").select("id",{count:"exact",head:!0}).gte("data_inicio",new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0]),a&&s.length>0?t.from("pacotes_aspiracao").select("id",{count:"exact",head:!0}).in("fazenda_id",s).gte("data_aspiracao",new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0]):t.from("pacotes_aspiracao").select("id",{count:"exact",head:!0}).gte("data_aspiracao",new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0]),a&&s.length>0?t.from("vw_receptoras_fazenda_atual").select("receptora_id",{count:"exact",head:!0}).in("fazenda_id_atual",s):t.from("receptoras").select("id",{count:"exact",head:!0}),a&&s.length>0?t.from("doadoras").select("id",{count:"exact",head:!0}).in("fazenda_id",s):t.from("doadoras").select("id",{count:"exact",head:!0}),a?t.from("embrioes").select("id",{count:"exact",head:!0}).eq("status_atual","CONGELADO").eq("cliente_id",a):t.from("embrioes").select("id",{count:"exact",head:!0}).eq("status_atual","CONGELADO"),a?t.from("doses_semen").select("id",{count:"exact",head:!0}).eq("cliente_id",a):t.from("doses_semen").select("id",{count:"exact",head:!0})]);g({protocolos:l.count??0,aspiracoes:b.count??0,receptoras:N.count??0,doadoras:v.count??0,embrioes:w.count??0,dosesSemen:_.count??0})}catch(s){console.error("Erro ao carregar estatísticas:",s)}finally{x(!1)}},f=[{title:"Serviços de Campo",description:"Protocolos, Aspirações, TE, DG e Sexagem",icon:y,route:"/relatorios/servicos",color:"bg-primary/10 text-primary"},{title:"Animais",description:"Receptoras e Doadoras",icon:R,route:"/relatorios/animais",color:"bg-amber-500/10 text-amber-600 dark:text-amber-400"},{title:"Material Genético",description:"Embriões e Doses de Sêmen",icon:p,route:"/relatorios/material",color:"bg-blue-500/10 text-blue-600 dark:text-blue-400"},{title:"Produção",description:"Lotes FIV e Métricas",icon:E,route:"/relatorios/producao",color:"bg-purple-500/10 text-purple-600 dark:text-purple-400"}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(T,{title:"Hub Relatórios",description:h.isCliente?"Visualize os dados e relatórios da sua conta":"Central de consultas e relatórios do sistema"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(r,{children:e.jsx(o,{className:"pt-4 pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(P,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:c?"...":i.protocolos}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Protocolos (30d)"})]})]})})}),e.jsx(r,{children:e.jsx(o,{className:"pt-4 pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(q,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:c?"...":i.aspiracoes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aspirações (30d)"})]})]})})}),e.jsx(r,{children:e.jsx(o,{className:"pt-4 pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-amber-500/10",children:e.jsx(D,{className:"w-5 h-5 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:c?"...":i.receptoras}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Receptoras"})]})]})})}),e.jsx(r,{children:e.jsx(o,{className:"pt-4 pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-500/10",children:e.jsx(m,{className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:c?"...":i.doadoras}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Doadoras"})]})]})})}),e.jsx(r,{children:e.jsx(o,{className:"pt-4 pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-cyan-500/10",children:e.jsx(p,{className:"w-5 h-5 text-cyan-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:c?"...":i.embrioes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Embriões Cong."})]})]})})}),e.jsx(r,{children:e.jsx(o,{className:"pt-4 pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-rose-500/10",children:e.jsx(m,{className:"w-5 h-5 text-rose-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:c?"...":i.dosesSemen}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Doses Sêmen"})]})]})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:f.map(s=>{const l=s.icon;return e.jsxs(r,{className:"cursor-pointer hover:shadow-md transition-shadow group",onClick:()=>u(s.route),children:[e.jsx(I,{className:"pb-2",children:e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${s.color}`,children:e.jsx(l,{className:"w-6 h-6"})})}),e.jsxs(o,{children:[e.jsxs(z,{className:"text-base mb-1 flex items-center justify-between",children:[s.title,e.jsx(L,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary group-hover:translate-x-1 transition-all"})]}),e.jsx(A,{children:s.description})]})]},s.route)})})]})}export{$ as default};
