import{r as i,f as b,s as m,j as e,a as E}from"./index-DM5u2d-F.js";import{C as T,a as v,b as w,d as y}from"./card-B_EQ6x91.js";import{T as N,a as z,b as h,c as r,d as S,e as n}from"./table-CEKyj1ed.js";import{P as _}from"./PageHeader-JgO8x5IE.js";import{E as F}from"./EmptyState-ChaxWsz8.js";import{h as H}from"./error-handler-BKHO4AyN.js";import"./use-toast-BOUGyrIz.js";function I(){const[o,x]=i.useState([]),[p,d]=i.useState(!0),j=b();i.useEffect(()=>{f()},[]);const f=async()=>{try{d(!0);const{data:a,error:c}=await m.from("fazendas").select("*").order("nome",{ascending:!0});if(c)throw c;const u=[...new Set(a==null?void 0:a.map(s=>s.cliente_id))],{data:t,error:l}=await m.from("clientes").select("id, nome").in("id",u);if(l)throw l;const g=new Map(t==null?void 0:t.map(s=>[s.id,s.nome])),C=a==null?void 0:a.map(s=>({...s,cliente_nome:g.get(s.cliente_id)}));x(C||[])}catch(a){H(a,"Erro ao carregar dados")}finally{d(!1)}};return p?e.jsx(E,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{title:"Fazendas",description:"Gerenciar fazendas do sistema"}),e.jsxs(T,{children:[e.jsx(v,{children:e.jsx(w,{children:"Lista de Fazendas"})}),e.jsx(y,{children:o.length===0?e.jsx(F,{title:"Nenhuma fazenda cadastrada",description:"Cadastre uma fazenda para começar."}):e.jsxs(N,{children:[e.jsx(z,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Nome"}),e.jsx(r,{children:"Cliente"}),e.jsx(r,{children:"Responsável"}),e.jsx(r,{children:"Contato"}),e.jsx(r,{children:"Localização"})]})}),e.jsx(S,{children:o.map(a=>e.jsxs(h,{className:"cursor-pointer hover:bg-slate-50",onClick:()=>j(`/fazendas/${a.id}`),children:[e.jsx(n,{className:"font-medium text-green-600",children:a.nome}),e.jsx(n,{children:a.cliente_nome||"-"}),e.jsx(n,{children:a.responsavel||"-"}),e.jsx(n,{children:a.contato_responsavel||"-"}),e.jsx(n,{children:a.localizacao||"-"})]},a.id))})]})})]})]})}export{I as default};
