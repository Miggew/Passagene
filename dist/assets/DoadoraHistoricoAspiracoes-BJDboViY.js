import{c as j,r,s as y,j as a,f as N}from"./index-B-7HRnm0.js";import{D as _,a as b,b as D,c as k}from"./dialog-CIXjHraQ.js";import{C as o}from"./CountBadge-BBpPT0CT.js";import{u as O}from"./use-toast-DDUqdzpY.js";import{f as A}from"./dateUtils-eJ5e6apA.js";import{D as E}from"./index-C6kCM6Yd.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=j("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);function S({doadoraId:i,doadoraNome:l,open:c,onClose:m}){const[t,p]=r.useState([]),[x,d]=r.useState(!1),{toast:u}=O();r.useEffect(()=>{c&&i&&f()},[c,i]);const f=async()=>{try{d(!0);const{data:e,error:s}=await y.from("aspiracoes_doadoras").select("*").eq("doadora_id",i).order("data_aspiracao",{ascending:!1});if(s)throw s;p(e||[])}catch(e){u({title:"Erro ao carregar histórico",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{d(!1)}},n=r.useMemo(()=>{const e=t.length,s=t.reduce((v,g)=>v+(g.total_oocitos||0),0),h=e>0?Math.round(s/e):0;return{total:e,totalOocitos:s,mediaOocitos:h}},[t]);return a.jsx(_,{open:c,onOpenChange:m,children:a.jsxs(b,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[a.jsx(D,{className:"pb-2",children:a.jsxs(k,{className:"text-base",children:["Histórico de Aspirações ",l&&`— ${l}`]})}),x?a.jsx("div",{className:"py-8",children:a.jsx(N,{})}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-4 pb-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Total Aspirações:"}),a.jsx(o,{value:n.total,variant:"default"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Total Oócitos:"}),a.jsx(o,{value:n.totalOocitos,variant:"primary"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Média/Aspiração:"}),a.jsx(o,{value:n.mediaOocitos,variant:"info"})]})]}),a.jsx(E,{data:t,rowKey:"id",rowNumber:!0,emptyMessage:"Nenhuma aspiração registrada para esta doadora",columns:[{key:"data_aspiracao",label:"Data"},{key:"total_oocitos",label:"Oócitos",align:"center"},{key:"veterinario_responsavel",label:"Veterinário"},{key:"tecnico_responsavel",label:"Técnico"}],renderCell:(e,s)=>{switch(s.key){case"data_aspiracao":return a.jsx("span",{className:"text-foreground",children:A(e.data_aspiracao)});case"total_oocitos":return a.jsx(o,{value:e.total_oocitos??0,variant:"primary"});case"veterinario_responsavel":return a.jsx("span",{className:"text-xs text-muted-foreground",children:e.veterinario_responsavel||"—"});case"tecnico_responsavel":return a.jsx("span",{className:"text-xs text-muted-foreground",children:e.tecnico_responsavel||"—"});default:return null}}})]})]})})}export{S as D,P};
