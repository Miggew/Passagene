import{k as v,a as j,r as d,s as m,j as e,i as C,B as f}from"./index-BPMeM9-O.js";import{C as g,a as N,b as y,d as E}from"./card-8azKTSNJ.js";import{I as h}from"./input-tqcTRdPv.js";import{L as u}from"./label-fluRYl3j.js";import{T as b}from"./textarea-B1aXpqcj.js";import{u as w}from"./use-toast-BGNwDi9e.js";import{A as S}from"./arrow-left-CjWJp082.js";function D(){const{id:s}=v(),c=j(),{toast:o}=w(),[n,i]=d.useState(!1),[a,l]=d.useState({nome:"",telefone:"",endereco:""});d.useEffect(()=>{s&&x()},[s]);const x=async()=>{try{i(!0);const{data:t,error:r}=await m.from("clientes").select("*").eq("id",s).single();if(r)throw r;t&&l({nome:t.nome||"",telefone:t.telefone||"",endereco:t.endereco||""})}catch(t){o({title:"Erro ao carregar cliente",description:t instanceof Error?t.message:"Erro desconhecido",variant:"destructive"})}finally{i(!1)}},p=async t=>{if(t.preventDefault(),!a.nome.trim()){o({title:"Erro de validação",description:"Nome é obrigatório",variant:"destructive"});return}try{if(i(!0),s){const{error:r}=await m.from("clientes").update(a).eq("id",s);if(r)throw r;o({title:"Cliente atualizado",description:"Cliente atualizado com sucesso"})}else{const{error:r}=await m.from("clientes").insert([a]);if(r)throw r;o({title:"Cliente criado",description:"Cliente criado com sucesso"})}c("/clientes")}catch(r){o({title:"Erro ao salvar cliente",description:r instanceof Error?r.message:"Erro desconhecido",variant:"destructive"})}finally{i(!1)}};return n&&s?e.jsx(C,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>c("/clientes"),children:e.jsx(S,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:s?"Editar Cliente":"Novo Cliente"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:s?"Atualizar informações do cliente":"Cadastrar novo cliente"})]})]}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsx(y,{children:"Informações do Cliente"})}),e.jsx(E,{children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"nome",children:"Nome *"}),e.jsx(h,{id:"nome",value:a.nome,onChange:t=>l({...a,nome:t.target.value}),placeholder:"Nome do cliente",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"telefone",children:"Telefone"}),e.jsx(h,{id:"telefone",value:a.telefone,onChange:t=>l({...a,telefone:t.target.value}),placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"endereco",children:"Endereço"}),e.jsx(b,{id:"endereco",value:a.endereco,onChange:t=>l({...a,endereco:t.target.value}),placeholder:"Endereço completo",rows:3})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(f,{type:"submit",disabled:n,children:n?"Salvando...":"Salvar"}),e.jsx(f,{type:"button",variant:"outline",onClick:()=>c("/clientes"),disabled:n,children:"Cancelar"})]})]})})]})]})}export{D as default};
