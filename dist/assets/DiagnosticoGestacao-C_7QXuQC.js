import{r as N,s as g,j as e,a as he,B as K}from"./index-DmNymSE5.js";import{e as Le,b as Fe}from"./dataEnrichment-DYYKz9BM.js";import{C as W,a as X,b as Y,d as ee}from"./card-SrkIpKk5.js";import{T as ve,a as xe,b as ae,c as S,d as Ee,e as T}from"./table-BEqiB4gi.js";import{S as je,a as we,b as be,c as De,d as te}from"./select-yD1hylSL.js";import{I as B}from"./input-CUsCheD8.js";import{L as Q}from"./label-u6KawL_e.js";import{T as $e}from"./textarea-BuM8ilf-.js";import{P as Ie}from"./PageHeader-C6hPTib0.js";import{E as Oe}from"./EmptyState-8CewmVht.js";import{S as qe}from"./StatusBadge-UrqKsWCC.js";import{u as Pe}from"./use-toast-8Wh80yTN.js";import{v as He}from"./receptoraStatus-DOv_raBa.js";import{D as Me}from"./DatePickerBR-DL95UOFW.js";import{C as Ge}from"./circle-check-big-Dw4nsJgC.js";import{L as Ve}from"./lock-c77r9b7d.js";import"./index-BoubMqWY.js";import"./index-C79PyqkA.js";import"./index-BMCBZPUE.js";import"./index-BMurdLVa.js";import"./check-D6LfuFSM.js";import"./badge-BB9l9AxT.js";import"./statusLabels-IklKT8dE.js";import"./popover-BabFSUJ1.js";import"./calendar-u0e6cTgk.js";function ga(){const[ce,se]=N.useState([]),[F,de]=N.useState(""),[le,M]=N.useState([]),[i,G]=N.useState(null),[z,$]=N.useState([]),[_e,Z]=N.useState(!1),[pe,me]=N.useState(!1),[ue,O]=N.useState(!1),{toast:L}=Pe(),[V,q]=N.useState({}),[f,I]=N.useState({veterinario_responsavel:"",tecnico_responsavel:""}),fe=new Date().toISOString().split("T")[0];N.useEffect(()=>{Ae()},[]),N.useEffect(()=>{F?ge(F):(M([]),G(null),$([]),q({}))},[F]),N.useEffect(()=>{i?i.status==="FECHADO"?(I({veterinario_responsavel:i.veterinario_dg||"",tecnico_responsavel:i.tecnico_dg||""}),O(!1),k(i)):i.veterinario_dg&&i.tecnico_dg?(I({veterinario_responsavel:i.veterinario_dg,tecnico_responsavel:i.tecnico_dg}),O(!1),k(i)):(I({veterinario_responsavel:"",tecnico_responsavel:""}),O(!0),$([]),q({})):($([]),q({}),O(!1))},[i]);const Ae=async()=>{try{const{data:a,error:n}=await g.from("fazendas").select("*").order("nome",{ascending:!0});if(n)throw n;const j=a||[],{data:h,error:t}=await g.from("vw_receptoras_fazenda_atual").select("receptora_id, fazenda_id_atual");if(t)throw t;const p=[...new Set((h||[]).map(d=>d.receptora_id).filter(Boolean))];if(p.length===0){se([]);return}const{data:A,error:R}=await g.from("receptoras").select("id").in("id",p).eq("status_reprodutivo","SERVIDA");if(R)throw R;const c=(A==null?void 0:A.map(d=>d.id))||[];if(c.length===0){se([]);return}const{data:o,error:_}=await g.from("transferencias_embrioes").select("receptora_id, data_te").in("receptora_id",c).eq("status_te","REALIZADA");if(_)throw _;const{data:u,error:w}=await g.from("diagnosticos_gestacao").select("receptora_id, data_te").in("receptora_id",c).eq("tipo_diagnostico","DG");if(w)throw w;const l=new Map((h||[]).filter(d=>d.receptora_id&&d.fazenda_id_atual).map(d=>[d.receptora_id,d.fazenda_id_atual])),v=new Map,r=new Map;(o||[]).forEach(d=>{const x=l.get(d.receptora_id);if(!x)return;const s=`${x}|${d.data_te}`;r.set(s,x),v.has(s)||v.set(s,new Set),v.get(s).add(d.receptora_id)});const m=new Map;(u||[]).forEach(d=>{const x=l.get(d.receptora_id);if(!x)return;const s=`${x}|${d.data_te}`;m.has(s)||m.set(s,new Set),m.get(s).add(d.receptora_id)});const C=new Set;v.forEach((d,x)=>{var E;if((((E=m.get(x))==null?void 0:E.size)||0)<d.size){const b=r.get(x);b&&C.add(b)}});const D=j.filter(d=>C.has(d.id));se(D),F&&!C.has(F)&&de("")}catch(a){L({title:"Erro ao carregar fazendas",description:a instanceof Error?a.message:"Erro desconhecido",variant:"destructive"})}},ge=async a=>{try{Z(!0);const{data:n,error:j}=await g.from("vw_receptoras_fazenda_atual").select("receptora_id").eq("fazenda_id_atual",a);if(j)throw j;const h=(n==null?void 0:n.map(r=>r.receptora_id))||[];if(h.length===0){M([]);return}const{data:t}=await g.from("receptoras").select("id, status_reprodutivo").in("id",h).eq("status_reprodutivo","SERVIDA"),p=(t==null?void 0:t.map(r=>r.id))||[];if(p.length===0){M([]);return}const{data:A,error:R}=await g.from("transferencias_embrioes").select("id, receptora_id, data_te").in("receptora_id",p).eq("status_te","REALIZADA").order("data_te",{ascending:!1});if(R)throw R;const{data:c}=await g.from("diagnosticos_gestacao").select("receptora_id, data_te, veterinario_responsavel, tecnico_responsavel, data_diagnostico").in("receptora_id",p).eq("tipo_diagnostico","DG").order("data_diagnostico",{ascending:!1}),o=new Map,_=new Map;A==null||A.forEach(r=>{var D;const m=`${a}-${r.data_te}`,C=`${r.data_te}-${r.receptora_id}`;if(_.has(r.data_te)||_.set(r.data_te,new Set),_.get(r.data_te).add(r.receptora_id),!o.has(m)){const d=c==null?void 0:c.find(x=>x.data_te===r.data_te);o.set(m,{id:m,fazenda_id:a,fazenda_nome:((D=ce.find(x=>x.id===a))==null?void 0:D.nome)||"",data_te:r.data_te,quantidade_receptoras:0,veterinario_dg:(d==null?void 0:d.veterinario_responsavel)||void 0,tecnico_dg:(d==null?void 0:d.tecnico_responsavel)||void 0,status:"ABERTO"})}}),o.forEach((r,m)=>{var d;const C=((d=_.get(r.data_te))==null?void 0:d.size)||0;r.quantidade_receptoras=C;const D=(c==null?void 0:c.filter(x=>x.data_te===r.data_te))||[];D.length>0&&D.length>=C?r.status="FECHADO":r.status="ABERTO"});const u=Array.from(o.values()).sort((r,m)=>new Date(m.data_te).getTime()-new Date(r.data_te).getTime()),w=u.filter(r=>r.status==="FECHADO").length,l=u.length-w,v=u.filter(r=>r.status==="ABERTO");M(v)}catch(n){L({title:"Erro ao carregar lotes",description:n instanceof Error?n.message:"Erro desconhecido",variant:"destructive"}),M([])}finally{Z(!1)}},Re=async()=>{if(!f.veterinario_responsavel.trim()||!f.tecnico_responsavel.trim()){L({title:"Erro de validação",description:"Veterinário e técnico responsáveis são obrigatórios",variant:"destructive"});return}if(!i)return;const a={...i,veterinario_dg:f.veterinario_responsavel.trim(),tecnico_dg:f.tecnico_responsavel.trim(),status:"ABERTO"};G(a),O(!1),await k(a)},k=async a=>{try{Z(!0);const{data:n,error:j}=await g.from("vw_receptoras_fazenda_atual").select("receptora_id").eq("fazenda_id_atual",a.fazenda_id);if(j)throw j;const h=(n==null?void 0:n.map(s=>s.receptora_id))||[];if(h.length===0){$([]);return}const{data:t,error:p}=await g.from("receptoras").select("id, identificacao, nome, status_reprodutivo").in("id",h).eq("status_reprodutivo","SERVIDA");if(p)throw p;const A=(t==null?void 0:t.map(s=>s.id))||[],{data:R,error:c}=await g.from("transferencias_embrioes").select("id, receptora_id, embriao_id, data_te").in("receptora_id",A).eq("data_te",a.data_te).eq("status_te","REALIZADA");if(c)throw c;if(!R||R.length===0){$([]);return}const o=R.map(s=>s.embriao_id).filter(Boolean);let _=new Map;if(o.length>0){const{data:s,error:E}=await g.from("embrioes").select("id, identificacao, classificacao, lote_fiv_id, lote_fiv_acasalamento_id").in("id",o);if(E)throw E;_=new Map((s==null?void 0:s.map(b=>[b.id,b]))||[])}const u=[...new Set(Array.from(_.values()).map(s=>s.lote_fiv_id).filter(Boolean))];let w=new Map;if(u.length>0){const{data:s,error:E}=await g.from("lotes_fiv").select("id, data_abertura").in("id",u);if(E)throw E;w=new Map((s==null?void 0:s.map(b=>[b.id,b]))||[])}const l=Le(Array.from(_.values())),{doadorasMap:v,tourosMap:r}=await Fe(l),{data:m}=await g.from("diagnosticos_gestacao").select("*").in("receptora_id",A).eq("tipo_diagnostico","DG").eq("data_te",a.data_te).order("data_diagnostico",{ascending:!1}),C=new Map;m==null||m.forEach(s=>{C.has(s.receptora_id)||C.set(s.receptora_id,s)});const D=new Map;R.forEach(s=>{const E=`${s.receptora_id}-${s.data_te}`;D.has(E)||D.set(E,[]),D.get(E).push(s)});const d=[];D.forEach((s,E)=>{const b=s[0],P=t==null?void 0:t.find(J=>J.id===b.receptora_id);if(!P)return;const re=[];let U=null,ie=null;if(s.forEach(J=>{const y=_.get(J.embriao_id);if(!y)return;const ne=w.get(y.lote_fiv_id);if(!ne)return;if(!U){U=ne.data_abertura;const ye=new Date(ne.data_abertura);ie=Math.floor((new Date().getTime()-ye.getTime())/(1e3*60*60*24))}const Ce=y.lote_fiv_acasalamento_id?v.get(y.lote_fiv_acasalamento_id):void 0,ze=y.lote_fiv_acasalamento_id?r.get(y.lote_fiv_acasalamento_id):void 0;re.push({te_id:J.id,embriao_id:y.id,embriao_identificacao:y.identificacao,embriao_classificacao:y.classificacao,lote_fiv_id:y.lote_fiv_id,lote_fiv_acasalamento_id:y.lote_fiv_acasalamento_id,doadora_registro:Ce,touro_nome:ze})}),re.length===0||!U||ie===null)return;const H=C.get(b.receptora_id);d.push({receptora_id:b.receptora_id,brinco:P.identificacao,nome:P.nome,status_reprodutivo:P.status_reprodutivo,data_te:b.data_te,embrioes:re,data_abertura_lote:U,dias_gestacao:ie,diagnostico_existente:H?{id:H.id,data_diagnostico:H.data_diagnostico,resultado:H.resultado,numero_gestacoes:H.numero_gestacoes||void 0,observacoes:H.observacoes||void 0}:void 0})}),d.sort((s,E)=>s.brinco.localeCompare(E.brinco)),$(d);const x={};d.forEach(s=>{var E;if(s.diagnostico_existente){const b=s.diagnostico_existente.resultado,P=((E=s.diagnostico_existente.numero_gestacoes)==null?void 0:E.toString())||(b==="PRENHE"||b==="RETOQUE"?"1":"");x[s.receptora_id]={resultado:b,numero_gestacoes:P,observacoes:s.diagnostico_existente.observacoes||"",data_diagnostico:s.diagnostico_existente.data_diagnostico}}else x[s.receptora_id]={resultado:"",numero_gestacoes:"",observacoes:"",data_diagnostico:fe}}),q(x)}catch(n){L({title:"Erro ao carregar receptoras",description:n instanceof Error?n.message:"Erro desconhecido",variant:"destructive"}),$([])}finally{Z(!1)}},Ne=(a,n)=>{q(j=>{const h=j[a]||{};let t=h.numero_gestacoes||"";return(n==="PRENHE"||n==="RETOQUE")&&!t?t="1":(n==="VAZIA"||n==="")&&(t=""),{...j,[a]:{...h,resultado:n,numero_gestacoes:t}}})},oe=(a,n,j)=>{q(h=>({...h,[a]:{...h[a],[n]:j}}))},Se=async()=>{var n,j,h;if(!i)return;if(!f.veterinario_responsavel.trim()||!f.tecnico_responsavel.trim()){L({title:"Erro de validação",description:"Veterinário e técnico responsáveis são obrigatórios",variant:"destructive"});return}const a=z.filter(t=>{const p=V[t.receptora_id];return!p||!p.resultado||!p.data_diagnostico});if(a.length>0){L({title:"Erro de validação",description:`Há ${a.length} receptora(s) sem resultado definido`,variant:"destructive"});return}try{me(!0);for(const c of z){const o=c.status_reprodutivo||"VAZIA",_=He(o,"REALIZAR_DG");if(!_.valido){L({title:"Erro de validação",description:`Receptora ${c.brinco}: ${_.mensagem}`,variant:"destructive"});return}}const t=[],p=[],A=[];if(z.forEach(c=>{var l,v;const o=V[c.receptora_id];if(!o||!o.resultado||!o.data_diagnostico)return;const _={receptora_id:c.receptora_id,data_te:c.data_te,tipo_diagnostico:"DG",data_diagnostico:o.data_diagnostico,resultado:o.resultado,observacoes:o.observacoes&&o.observacoes.trim()||void 0};o.resultado==="PRENHE"||o.resultado==="RETOQUE"?o.numero_gestacoes?_.numero_gestacoes=parseInt(o.numero_gestacoes):_.numero_gestacoes=1:_.numero_gestacoes=0,(l=f.veterinario_responsavel)!=null&&l.trim()&&(_.veterinario_responsavel=f.veterinario_responsavel.trim()),(v=f.tecnico_responsavel)!=null&&v.trim()&&(_.tecnico_responsavel=f.tecnico_responsavel.trim()),c.diagnostico_existente?p.push({id:c.diagnostico_existente.id,..._}):t.push(_);let u,w=null;if(o.resultado==="PRENHE"){u="PRENHE";const r=new Date(c.data_abertura_lote),m=new Date(r);m.setDate(m.getDate()+275),w=m.toISOString().split("T")[0]}else if(o.resultado==="RETOQUE"){u="PRENHE_RETOQUE";const r=new Date(c.data_abertura_lote),m=new Date(r);m.setDate(m.getDate()+275),w=m.toISOString().split("T")[0]}else u="VAZIA",o.numero_gestacoes="";A.push({receptora_id:c.receptora_id,status:u,dataParto:w})}),t.length>0){const c=t.map(l=>`${l.receptora_id}-${l.data_te}-${l.tipo_diagnostico}`),{data:o,error:_}=await g.from("diagnosticos_gestacao").select("id, receptora_id, data_te, tipo_diagnostico").in("receptora_id",[...new Set(t.map(l=>l.receptora_id))]).eq("tipo_diagnostico","DG"),u=new Map;o==null||o.forEach(l=>{const v=`${l.receptora_id}-${l.data_te}-${l.tipo_diagnostico}`;u.set(v,l.id)});const w=[];if(t.forEach(l=>{const v=`${l.receptora_id}-${l.data_te}-${l.tipo_diagnostico}`,r=u.get(v);r?p.push({id:r,...l}):w.push(l)}),w.length>0){const{error:l}=await g.from("diagnosticos_gestacao").insert(w);if(l)if((n=l.message)!=null&&n.includes("column")||l.code==="42703"){const v=w.map(({veterinario_responsavel:m,tecnico_responsavel:C,...D})=>D),{error:r}=await g.from("diagnosticos_gestacao").insert(v);if(r)throw new Error(`Erro ao inserir diagnósticos: ${r.message}. Verifique se os campos estão corretos no banco de dados.`)}else throw l.code==="23505"||(j=l.message)!=null&&j.includes("unique")?new Error("Erro de duplicação: alguns diagnósticos já existem. Recarregue a página e tente novamente."):new Error(`Erro ao inserir diagnósticos: ${l.message||l.code||"Erro desconhecido"}`)}}if(p.length>0)for(const c of p){const{id:o,..._}=c;let{error:u}=await g.from("diagnosticos_gestacao").update(_).eq("id",o);if(u&&((h=u.message)!=null&&h.includes("column")||u.code==="42703")){const{veterinario_responsavel:w,tecnico_responsavel:l,...v}=_,{error:r}=await g.from("diagnosticos_gestacao").update(v).eq("id",o);if(r)throw new Error(`Erro ao atualizar diagnóstico ${o}: ${r.message}`)}else if(u)throw new Error(`Erro ao atualizar diagnóstico ${o}: ${u.message||u.code||"Erro desconhecido"}`)}for(const c of A){const o={status_reprodutivo:c.status};c.dataParto?o.data_provavel_parto=c.dataParto:c.status==="VAZIA"&&(o.data_provavel_parto=null);const{error:_}=await g.from("receptoras").update(o).eq("id",c.receptora_id);if(_)throw new Error(`Erro ao atualizar status da receptora ${c.receptora_id}`)}const R=z.every(c=>{const o=V[c.receptora_id];return o&&o.resultado&&o.data_diagnostico});G({...i,veterinario_dg:f.veterinario_responsavel.trim(),tecnico_dg:f.tecnico_responsavel.trim(),status:R?"FECHADO":"ABERTO"}),L({title:"Lote salvo com sucesso",description:R?`${z.length} diagnóstico(s) registrado(s). Lote fechado.`:`${z.length} diagnóstico(s) registrado(s)`}),await ge(F),i&&await k(i)}catch(t){let p="Erro desconhecido";t instanceof Error&&(p=t.message,t.message.includes("column")&&t.message.includes("does not exist")?p="Os campos veterinario_responsavel e tecnico_responsavel não existem na tabela. Execute o script SQL add_veterinario_tecnico_dg.sql primeiro.":t.message.includes("unique")||t.message.includes("duplicate")?p="Já existe um diagnóstico para esta receptora nesta data. Tente recarregar a página.":(t.message.includes("foreign key")||t.message.includes("constraint"))&&(p="Erro de integridade dos dados. Verifique se todas as informações estão corretas.")),L({title:"Erro ao salvar lote",description:p,variant:"destructive"})}finally{me(!1)}},Te=z.every(a=>{const n=V[a.receptora_id];return n&&n.resultado&&n.data_diagnostico});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ie,{title:"Diagnóstico de Gestação (DG)",description:"Registrar diagnósticos de gestação por lote de TE"}),e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Selecionar Fazenda"})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"fazenda",children:"Fazenda *"}),e.jsxs(je,{value:F,onValueChange:de,children:[e.jsx(we,{children:e.jsx(be,{placeholder:"Selecione a fazenda"})}),e.jsx(De,{children:ce.map(a=>e.jsx(te,{value:a.id,children:a.nome},a.id))})]})]})})]}),F&&e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Lotes de Transferência de Embriões"})}),e.jsx(ee,{children:_e?e.jsx(he,{}):le.length===0?e.jsx(Oe,{title:"Nenhum lote de TE encontrado",description:"Selecione outra fazenda ou verifique se há transferências registradas."}):e.jsxs(ve,{children:[e.jsx(xe,{children:e.jsxs(ae,{children:[e.jsx(S,{children:"Data TE"}),e.jsx(S,{children:"Quantidade"}),e.jsx(S,{children:"Vet. DG"}),e.jsx(S,{children:"Téc. DG"}),e.jsx(S,{className:"text-right",children:"Ações"})]})}),e.jsx(Ee,{children:le.map(a=>e.jsxs(ae,{className:(i==null?void 0:i.id)===a.id?"bg-blue-50":"",children:[e.jsx(T,{className:"font-medium",children:new Date(a.data_te).toLocaleDateString("pt-BR")}),e.jsxs(T,{children:[a.quantidade_receptoras," receptoras"]}),e.jsx(T,{children:a.veterinario_dg||"-"}),e.jsx(T,{children:a.tecnico_dg||"-"}),e.jsx(T,{className:"text-right",children:e.jsx(K,{size:"sm",onClick:()=>G(a),variant:(i==null?void 0:i.id)===a.id?"default":"outline",children:(i==null?void 0:i.id)===a.id?"Selecionado":"Selecionar"})})]},a.id))})]})})]}),i&&ue&&e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Abrir Lote de DG"})}),e.jsxs(ee,{className:"space-y-4",children:[e.jsxs("p",{className:"text-slate-600",children:["Lote de TE em ",new Date(i.data_te).toLocaleDateString("pt-BR")," - ",i.quantidade_receptoras," receptoras"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"veterinario",children:"Veterinário Responsável *"}),e.jsx(B,{id:"veterinario",value:f.veterinario_responsavel,onChange:a=>I({...f,veterinario_responsavel:a.target.value}),placeholder:"Nome do veterinário"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"tecnico",children:"Técnico Responsável *"}),e.jsx(B,{id:"tecnico",value:f.tecnico_responsavel,onChange:a=>I({...f,tecnico_responsavel:a.target.value}),placeholder:"Nome do técnico"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{onClick:Re,className:"bg-green-600 hover:bg-green-700",disabled:!f.veterinario_responsavel.trim()||!f.tecnico_responsavel.trim(),children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Abrir Lote"]}),e.jsx(K,{variant:"outline",onClick:()=>{O(!1),G(null)},children:"Cancelar"})]})]})]}),i&&!ue&&z.length>0&&e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Y,{children:["Receptoras do Lote - ",z.length," ",z.length===1?"receptora":"receptoras",i.status==="FECHADO"&&e.jsx("span",{className:"ml-2 text-sm text-slate-500",children:"(Lote Fechado - Somente Leitura)"})]}),i.status==="ABERTO"&&e.jsxs(K,{onClick:Se,disabled:!Te||pe,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),pe?"Salvando...":"Salvar Lote Completo"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"veterinario_dg",children:"Veterinário Responsável (DG) *"}),e.jsx(B,{id:"veterinario_dg",value:f.veterinario_responsavel,onChange:a=>I({...f,veterinario_responsavel:a.target.value}),placeholder:"Nome do veterinário",disabled:i.status==="FECHADO"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"tecnico_dg",children:"Técnico Responsável (DG) *"}),e.jsx(B,{id:"tecnico_dg",value:f.tecnico_responsavel,onChange:a=>I({...f,tecnico_responsavel:a.target.value}),placeholder:"Nome do técnico",disabled:i.status==="FECHADO"})]})]})]})}),e.jsx(ee,{children:_e?e.jsx(he,{}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ve,{children:[e.jsx(xe,{children:e.jsxs(ae,{children:[e.jsx(S,{children:"Receptora"}),e.jsx(S,{children:"Dias Gestação"}),e.jsx(S,{children:"Embrião(ões)"}),e.jsx(S,{children:"Doadora / Touro"}),e.jsx(S,{children:"Data DG"}),e.jsx(S,{children:"Resultado"}),e.jsx(S,{children:"Nº Gest."}),e.jsx(S,{children:"Observações"})]})}),e.jsx(Ee,{children:z.map(a=>{var h;const n=V[a.receptora_id]||{resultado:"",numero_gestacoes:"",observacoes:"",data_diagnostico:fe},j=!!a.diagnostico_existente;return e.jsxs(ae,{children:[e.jsxs(T,{className:"font-medium",children:[a.brinco,a.nome&&e.jsxs("span",{className:"text-slate-500 text-sm ml-2",children:["(",a.nome,")"]}),j&&e.jsx(qe,{status:((h=a.diagnostico_existente)==null?void 0:h.resultado)||"",className:"ml-2"})]}),e.jsxs(T,{children:[e.jsx("span",{className:"font-semibold",children:a.dias_gestacao})," dias"]}),e.jsx(T,{children:e.jsx("div",{className:"space-y-1",children:a.embrioes.map((t,p)=>e.jsx("div",{className:"text-sm",children:e.jsxs("div",{className:"font-medium",children:[t.embriao_identificacao||`Embrião ${p+1}`,t.embriao_classificacao&&e.jsxs("span",{className:"text-slate-500 ml-2",children:["(",t.embriao_classificacao,")"]})]})},t.te_id))})}),e.jsx(T,{children:e.jsx("div",{className:"space-y-1",children:a.embrioes.map((t,p)=>e.jsx("div",{className:"text-sm",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:t.doadora_registro||"-"}),t.doadora_registro&&t.touro_nome&&" × ",e.jsx("span",{className:"font-medium",children:t.touro_nome||""})]})},t.te_id))})}),e.jsx(T,{children:e.jsx(Me,{value:n.data_diagnostico,onChange:t=>oe(a.receptora_id,"data_diagnostico",t||""),className:"w-36",disabled:i.status==="FECHADO"})}),e.jsx(T,{children:e.jsxs(je,{value:n.resultado,onValueChange:t=>Ne(a.receptora_id,t),disabled:i.status==="FECHADO",children:[e.jsx(we,{className:"w-32",children:e.jsx(be,{placeholder:"Resultado"})}),e.jsxs(De,{children:[e.jsx(te,{value:"PRENHE",children:"PRENHE"}),e.jsx(te,{value:"VAZIA",children:"VAZIA"}),e.jsx(te,{value:"RETOQUE",children:"RETOQUE"})]})]})}),e.jsx(T,{children:n.resultado==="PRENHE"||n.resultado==="RETOQUE"?e.jsx(B,{type:"number",min:"1",max:"3",value:n.numero_gestacoes,onChange:t=>oe(a.receptora_id,"numero_gestacoes",t.target.value),placeholder:"1-3",className:"w-20",disabled:i.status==="FECHADO"}):e.jsx("span",{className:"text-slate-400",children:"-"})}),e.jsx(T,{children:e.jsx($e,{value:n.observacoes,onChange:t=>oe(a.receptora_id,"observacoes",t.target.value),placeholder:"Observações",rows:2,className:"w-48",disabled:i.status==="FECHADO"})})]},a.receptora_id)})})]})})})]})]})}export{ga as default};
