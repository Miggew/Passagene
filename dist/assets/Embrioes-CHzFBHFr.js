import{c as Se,r as c,s as $,j as e,h as P,o as Na,I as Da,J as Ea,K as Ps,M as Is,N as Ye,v as Ue,n as k,P as ye,O as ks,Q as zs,V as As,W as Ts,X as Os,t as Ma,f as ve,S as ea,k as Fs,g as Bs}from"./index-CvlUDCD-.js";import{S as oa,a as na,b as ra,c as ia,d as ge,f as Ls,u as Gs,C as $s,e as Ks}from"./select-CRV7QsOQ.js";import{L as be}from"./label-BIMTC7_j.js";import{P as Us}from"./PageHeader-Don16aHL.js";import{E as Hs}from"./EmptyState-DFkj0E0i.js";import{u as Sa,C as Vs,a as qs,c as Xs}from"./use-toast-BhbfqK05.js";import{h as Qe}from"./error-handler-CiAOpFaY.js";import{P as Ys,h as Ws,b as Js,R as Zs,F as Qs,u as et,a as ga}from"./index-BYe3zTS0.js";import{c as ya,I as at,R as st}from"./index-Mm2kbPk7.js";import{c as Ra,b as tt,C as ot,D as Pa}from"./DatePickerBR-gAx3gAQT.js";import{C as aa}from"./check-BbN618wW.js";import{B as Me}from"./badge-C6XBkHcG.js";import{S as nt}from"./StatusBadge-Dl4aSm-D.js";import{T as sa}from"./sheet-Bfcmzecc.js";import{U as Ia}from"./user-BGYI8phH.js";import{T as ka}from"./trash-2-ChiqfJUw.js";import{M as rt}from"./map-pin-CAPZ6-1g.js";import{T as va}from"./triangle-alert-CjUkaJWP.js";import{P as it}from"./package-L5ylPkNI.js";import{X as ct}from"./x-DpiajgWI.js";import{D as Re,b as Pe,c as Ie,d as ke,e as ca,f as lt}from"./dialog-DSJKtNd7.js";import{I as dt}from"./input-BiDTc9_9.js";import{T as ut}from"./textarea-CWzGJoHk.js";import"./index-CDlvsNjp.js";import"./popover-D6dVxm31.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=Se("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Se("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Se("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=Se("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=Se("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),za="embrioes_filtros",ja=20,ht=()=>{try{const a=localStorage.getItem(za);return a?JSON.parse(a):{}}catch{return{}}},xt=a=>{if(!a)return null;const t=new Date,s=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0"),[o,r,i]=s.split("-").map(Number),[d,l,g]=a.split("-").map(Number),_=Date.UTC(o,r-1,i),p=Date.UTC(d,l-1,g);return Math.floor((_-p)/(1e3*60*60*24))};function gt(){const a=c.useMemo(()=>ht(),[]),[t,s]=c.useState([]),[o,r]=c.useState([]),[i,d]=c.useState([]),[l,g]=c.useState([]),[_,p]=c.useState(!1),[u,v]=c.useState(a.selectedFazendaDestinoId??""),[b,C]=c.useState(a.paginasPacotes??{}),[E,K]=c.useState({});c.useEffect(()=>{const f={selectedFazendaDestinoId:u,paginasPacotes:b};localStorage.setItem(za,JSON.stringify(f))},[u,b]),c.useEffect(()=>{C(f=>{let j=!1;const D={...f};return o.forEach(T=>{const B=Math.max(1,Math.ceil(T.embrioes.length/ja));if(!D[T.id]){D[T.id]=1,j=!0;return}D[T.id]>B&&(D[T.id]=B,j=!0)}),j?D:f})},[o]);const U=c.useCallback(f=>(E[f.id]??f.classificacao??"").trim(),[E]),z=c.useCallback(f=>{const j={BE:0,BN:0,BX:0,BL:0,BI:0};let D=0;return f.embrioes.forEach(T=>{const B=U(T).toUpperCase();if(!B){D+=1;return}B==="BE"?j.BE+=1:B==="BN"?j.BN+=1:B==="BX"?j.BX+=1:B==="BL"?j.BL+=1:B==="BI"&&(j.BI+=1)}),{semClassificacao:D,classificados:j,total:f.total,todosClassificados:f.total>0&&D===0}},[U]),H=c.useCallback(async()=>{try{const{data:f,error:j}=await $.from("fazendas").select("id, nome").order("nome",{ascending:!0});if(j)throw j;d(f||[])}catch(f){Qe(f,"Erro ao carregar fazendas")}},[]),x=c.useCallback(async()=>{try{const{data:f,error:j}=await $.from("clientes").select("id, nome").order("nome",{ascending:!0});if(j)throw j;g(f||[])}catch(f){Qe(f,"Erro ao carregar clientes")}},[]),F=c.useCallback(async()=>{try{p(!0);const{data:f,error:j}=await $.from("embrioes").select("*").in("status_atual",["FRESCO","CONGELADO"]).is("cliente_id",null).order("created_at",{ascending:!1});if(j)throw j;if(!f||f.length===0){s([]),r([]),p(!1);return}const D=[...new Set(f.filter(n=>n.lote_fiv_acasalamento_id).map(n=>n.lote_fiv_acasalamento_id))],T=[...new Set(f.filter(n=>n.lote_fiv_id).map(n=>n.lote_fiv_id))],B=[...new Set(f.filter(n=>n.fazenda_destino_id).map(n=>n.fazenda_destino_id))];if(D.length===0){s(f),r([]),p(!1);return}const[W,me]=await Promise.all([$.from("lote_fiv_acasalamentos").select("id, aspiracao_doadora_id, dose_semen_id").in("id",D),T.length>0?$.from("lotes_fiv").select("id, pacote_aspiracao_id, data_fecundacao").in("id",T):Promise.resolve({data:null,error:null})]);if(W.error)throw W.error;const ee=W.data||[],ae=me.data||[],de=[...new Set(ee.map(n=>n.aspiracao_doadora_id))],pe=[...new Set(ee.map(n=>n.dose_semen_id))],J=[...new Set(ae.map(n=>n.pacote_aspiracao_id).filter(Boolean))],h=new Map,L=new Map;ae.forEach(n=>{n.pacote_aspiracao_id&&h.set(n.id,n.pacote_aspiracao_id),n.data_fecundacao&&L.set(n.id,n.data_fecundacao)});const[V,X,se]=await Promise.all([de.length>0?$.from("aspiracoes_doadoras").select("id, doadora_id, pacote_aspiracao_id").in("id",de):Promise.resolve({data:null,error:null}),pe.length>0?$.from("doses_semen").select("id, touro_id, touro:touros(id, nome, registro, raca)").in("id",pe):Promise.resolve({data:null,error:null}),J.length>0?$.from("pacotes_aspiracao").select("id, data_aspiracao, fazenda_id, fazenda_destino_id, horario_inicio, veterinario_responsavel, total_oocitos").in("id",J):Promise.resolve({data:null,error:null})]);if(V.error)throw V.error;if(X.error)throw X.error;const te=V.data||[],he=X.data||[],Z=se.data||[],oe=[...new Set(te.map(n=>n.doadora_id))],O=new Set(B);Z.forEach(n=>{n.fazenda_id&&O.add(n.fazenda_id),n.fazenda_destino_id&&O.add(n.fazenda_destino_id)});const[G,xe,le]=await Promise.all([oe.length>0?$.from("doadoras").select("id, registro").in("id",oe):Promise.resolve({data:null,error:null}),O.size>0?$.from("fazendas").select("id, nome").in("id",Array.from(O)):Promise.resolve({data:null,error:null}),J.length>0?$.from("pacotes_aspiracao_fazendas_destino").select("pacote_aspiracao_id, fazenda_destino_id").in("pacote_aspiracao_id",J):Promise.resolve({data:null,error:null})]);if(G.error)throw G.error;const ze=G.data||[],Ae=xe.data||[],_e=le.data||[],we=new Map(Ae.map(n=>[n.id,n.nome])),ue=new Map;_e.forEach(n=>{const R=ue.get(n.pacote_aspiracao_id)||[];R.includes(n.fazenda_destino_id)||R.push(n.fazenda_destino_id),ue.set(n.pacote_aspiracao_id,R)}),Z.forEach(n=>{if(n.fazenda_destino_id){const R=ue.get(n.id)||[];R.includes(n.fazenda_destino_id)||R.push(n.fazenda_destino_id),ue.set(n.id,R)}});const re=new Map;te.forEach(n=>{n.pacote_aspiracao_id&&re.set(n.pacote_aspiracao_id,(re.get(n.pacote_aspiracao_id)||0)+1)});const ie=new Map;Z.forEach(n=>{ie.set(n.id,{id:n.id,data_aspiracao:n.data_aspiracao,fazenda_nome:we.get(n.fazenda_id),quantidade_doadoras:re.get(n.id)||0,horario_inicio:n.horario_inicio,veterinario_responsavel:n.veterinario_responsavel,total_oocitos:n.total_oocitos})});const Te=new Map(te.map(n=>[n.id,n])),Oe=new Map(ze.map(n=>[n.id,n])),w=new Map(he.map(n=>[n.id,n])),N=new Map(ee.map(n=>[n.id,n])),S=f.map(n=>{var ne;const R=n.lote_fiv_acasalamento_id?N.get(n.lote_fiv_acasalamento_id):void 0,I=R?Te.get(R.aspiracao_doadora_id):void 0,Y=I?Oe.get(I.doadora_id):void 0,Ce=R?w.get(R.dose_semen_id):void 0,Ee=n.lote_fiv_id?h.get(n.lote_fiv_id):void 0,Fe=Ee?ie.get(Ee):void 0;return{...n,doadora_registro:Y==null?void 0:Y.registro,touro_nome:(ne=Ce==null?void 0:Ce.touro)==null?void 0:ne.nome,fazenda_destino_nome:n.fazenda_destino_id?we.get(n.fazenda_destino_id):void 0,data_aspiracao:Fe==null?void 0:Fe.data_aspiracao,pacote_aspiracao_id:Ee}}),y=new Map;S.forEach(n=>{var xa;if(!n.lote_fiv_id)return;const R=((xa=n.created_at)==null?void 0:xa.split("T")[0])||"",I=`${n.lote_fiv_id}_${R}`,Y=n.lote_fiv_id?h.get(n.lote_fiv_id):void 0,Ce=Y?ie.get(Y):void 0,Ee=Y?ue.get(Y)||[]:[],Fe=Ee.map(je=>we.get(je)||"N/A");y.has(I)||y.set(I,{id:I,lote_fiv_id:n.lote_fiv_id,data_despacho:R,data_fecundacao:n.lote_fiv_id?L.get(n.lote_fiv_id):void 0,fazendas_destino_ids:Ee,fazendas_destino_nomes:Fe,pacote_info:Ce||{id:Y||"",data_aspiracao:"",quantidade_doadoras:0},embrioes:[],total:0,frescos:0,congelados:0,sem_classificacao:0,classificados:{BE:0,BN:0,BX:0,BL:0,BI:0}});const ne=y.get(I);if(ne.embrioes.push(n),ne.total++,n.status_atual==="FRESCO"&&ne.frescos++,n.status_atual==="CONGELADO"&&ne.congelados++,!n.classificacao)ne.sem_classificacao++;else{const je=n.classificacao.toUpperCase();je==="BE"?ne.classificados.BE++:je==="BN"?ne.classificados.BN++:je==="BX"?ne.classificados.BX++:je==="BL"?ne.classificados.BL++:je==="BI"&&ne.classificados.BI++}});const fe=(u?Array.from(y.values()).filter(n=>n.fazendas_destino_ids.includes(u)):Array.from(y.values())).sort((n,R)=>{const I=new Date(n.data_despacho).getTime();return new Date(R.data_despacho).getTime()-I});fe.forEach(n=>{n.todos_classificados=n.total>0&&n.sem_classificacao===0,n.disponivel_para_transferencia=n.todos_classificados&&n.frescos>0});const m=new Set(fe.map(n=>n.id)),A=S.filter(n=>{var Y;if(!n.lote_fiv_id)return!1;const R=((Y=n.created_at)==null?void 0:Y.split("T")[0])||"",I=`${n.lote_fiv_id}_${R}`;return m.has(I)});s(A),r(fe)}catch(f){Qe(f,"Erro ao carregar embriões")}finally{p(!1)}},[u]),M=c.useCallback(async()=>{await F()},[F]);return{embrioes:t,pacotes:o,fazendas:i,clientes:l,loading:_,selectedFazendaDestinoId:u,setSelectedFazendaDestinoId:v,paginasPacotes:b,setPaginasPacotes:C,pageSize:ja,loadData:F,loadFazendas:H,loadClientes:x,reloadData:M,getClassificacaoAtual:U,getResumoPacote:z,classificacoesPendentes:E,setClassificacoesPendentes:K}}const Be=async(a,t,s,o,r,i)=>{try{await $.from("historico_embrioes").insert([{embriao_id:a,status_anterior:t,status_novo:s,tipo_operacao:o,fazenda_id:r||null,observacoes:i||null,data_mudanca:new Date().toISOString()}])}catch{}};function vt({embrioes:a,pacotes:t,classificacoesPendentes:s,setClassificacoesPendentes:o,onSuccess:r}){const{toast:i}=Sa(),d=new Date().toISOString().split("T")[0],[l,g]=c.useState(new Set),[_,p]=c.useState(!1),[u,v]=c.useState(!1),[b,C]=c.useState(!1),[E,K]=c.useState(!1),[U,z]=c.useState(!1),[H,x]=c.useState(!1),[F,M]=c.useState(!1),[f,j]=c.useState({data_congelamento:d,localizacao_atual:""}),[D,T]=c.useState({data_descarte:d,observacoes:""}),[B,W]=c.useState({cliente_id:""}),[me,ee]=c.useState(null),[ae,de]=c.useState(null),[pe,J]=c.useState(null),[h,L]=c.useState(null),[V,X]=c.useState([]),[se,te]=c.useState([]),[he,Z]=c.useState(!1),[oe,O]=c.useState(!1),G=c.useCallback(w=>{g(N=>{const S=new Set(N);return S.has(w)?S.delete(w):S.add(w),S})},[]),xe=c.useCallback(w=>{const N=t.find(q=>q.id===w);if(!N)return;const S=N.embrioes.filter(q=>q.status_atual==="FRESCO").map(q=>q.id),y=S.every(q=>l.has(q));g(q=>{const fe=new Set(q);return y?S.forEach(m=>fe.delete(m)):S.forEach(m=>fe.add(m)),fe})},[t,l]),le=c.useCallback(()=>{g(new Set),p(!1)},[]),ze=c.useCallback(w=>l.has(w),[l]),Ae=c.useCallback(async w=>{try{Z(!0);const{data:N,error:S}=await $.from("historico_embrioes").select("*, fazenda:fazendas(nome)").eq("embriao_id",w).order("data_mudanca",{ascending:!1});if(S)throw S;te(N||[])}catch(N){i({title:"Erro ao carregar histórico",description:N instanceof Error?N.message:"Erro desconhecido",variant:"destructive"})}finally{Z(!1)}},[i]),_e=c.useCallback(async()=>{if(l.size===0){i({title:"Nenhum embrião selecionado",description:"Selecione pelo menos um embrião para congelar.",variant:"destructive"});return}if(!f.localizacao_atual.trim()){i({title:"Localização obrigatória",description:"Informe a localização de armazenamento.",variant:"destructive"});return}try{O(!0);const w=Array.from(l),{error:N}=await $.from("embrioes").update({status_atual:"CONGELADO",data_congelamento:f.data_congelamento,localizacao_atual:f.localizacao_atual.trim()}).in("id",w);if(N)throw N;for(const S of w){const y=a.find(q=>q.id===S);await Be(S,(y==null?void 0:y.status_atual)||null,"CONGELADO","CONGELAMENTO",null,`Congelado em ${f.localizacao_atual.trim()}`)}i({title:"Embriões congelados",description:`${w.length} embrião(ões) congelado(s) com sucesso.`}),v(!1),le(),j({data_congelamento:d,localizacao_atual:""}),await r()}catch(w){i({title:"Erro ao congelar embriões",description:w instanceof Error?w.message:"Erro desconhecido",variant:"destructive"})}finally{O(!1)}},[l,f,a,d,i,le,r]),we=c.useCallback(async()=>{if(l.size===0){i({title:"Nenhum embrião selecionado",description:"Selecione pelo menos um embrião para descartar.",variant:"destructive"});return}try{O(!0);const w=Array.from(l),{error:N}=await $.from("embrioes").update({status_atual:"DESCARTADO",data_descarte:D.data_descarte,observacoes:D.observacoes.trim()||null}).in("id",w);if(N)throw N;for(const S of w){const y=a.find(q=>q.id===S);await Be(S,(y==null?void 0:y.status_atual)||null,"DESCARTADO","DESCARTE",null,D.observacoes.trim()||null)}i({title:"Embriões descartados",description:`${w.length} embrião(ões) descartado(s).`}),C(!1),le(),T({data_descarte:d,observacoes:""}),await r()}catch(w){i({title:"Erro ao descartar embriões",description:w instanceof Error?w.message:"Erro desconhecido",variant:"destructive"})}finally{O(!1)}},[l,D,a,d,i,le,r]),ue=c.useCallback(async w=>{if(l.size===0){i({title:"Nenhum embrião selecionado",description:"Selecione pelo menos um embrião.",variant:"destructive"});return}if(!B.cliente_id){i({title:"Cliente não selecionado",description:"Selecione o cliente de destino.",variant:"destructive"});return}try{O(!0);const N=Array.from(l),{error:S}=await $.from("embrioes").update({cliente_id:B.cliente_id}).in("id",N);if(S)throw S;const y=w.find(q=>q.id===B.cliente_id);for(const q of N)await Be(q,null,"DIRECIONADO","DESTINACAO",null,`Direcionado para cliente: ${(y==null?void 0:y.nome)||"N/A"}`);i({title:"Embriões direcionados",description:`${N.length} embrião(ões) direcionado(s) para ${(y==null?void 0:y.nome)||"cliente"}.`}),z(!1),le(),W({cliente_id:""}),await r()}catch(N){i({title:"Erro ao direcionar embriões",description:N instanceof Error?N.message:"Erro desconhecido",variant:"destructive"})}finally{O(!1)}},[l,B,i,le,r]),re=c.useCallback(async()=>{const w=Object.entries(s);if(w.length===0){i({title:"Nenhuma classificação pendente",description:"Não há classificações para salvar."});return}try{O(!0);for(const[N,S]of w){const{error:y}=await $.from("embrioes").update({classificacao:S.toUpperCase()}).eq("id",N);if(y)throw y;await Be(N,null,S.toUpperCase(),"CLASSIFICACAO",null,`Classificado como ${S.toUpperCase()}`)}i({title:"Classificações salvas",description:`${w.length} embrião(ões) classificado(s).`}),o({}),await r()}catch(N){i({title:"Erro ao salvar classificações",description:N instanceof Error?N.message:"Erro desconhecido",variant:"destructive"})}finally{O(!1)}},[s,o,i,r]),ie=c.useCallback(async()=>{K(!1),ee(null)},[]),Te=c.useCallback(async()=>{if(ae)try{O(!0);const{error:w}=await $.from("embrioes").update({status_atual:"DESCARTADO",data_descarte:D.data_descarte,observacoes:D.observacoes.trim()||null}).eq("id",ae.id);if(w)throw w;await Be(ae.id,ae.status_atual,"DESCARTADO","DESCARTE",null,D.observacoes.trim()||null),i({title:"Embrião descartado",description:"Embrião descartado com sucesso."}),C(!1),de(null),T({data_descarte:d,observacoes:""}),await r()}catch(w){i({title:"Erro ao descartar embrião",description:w instanceof Error?w.message:"Erro desconhecido",variant:"destructive"})}finally{O(!1)}},[ae,D,d,i,r]),Oe=c.useCallback(async()=>{if(h)try{if(O(!0),await $.from("pacotes_aspiracao_fazendas_destino").delete().eq("pacote_aspiracao_id",h.pacote_info.id),V.length>0){const w=V.map(S=>({pacote_aspiracao_id:h.pacote_info.id,fazenda_destino_id:S})),{error:N}=await $.from("pacotes_aspiracao_fazendas_destino").insert(w);if(N)throw N}i({title:"Fazendas destino atualizadas",description:"As fazendas destino foram atualizadas com sucesso."}),M(!1),L(null),X([]),await r()}catch(w){i({title:"Erro ao salvar fazendas destino",description:w instanceof Error?w.message:"Erro desconhecido",variant:"destructive"})}finally{O(!1)}},[h,V,i,r]);return{embrioesSelecionados:l,setEmbrioesSelecionados:g,showAcoesEmMassa:_,setShowAcoesEmMassa:p,showCongelarDialog:u,setShowCongelarDialog:v,showDescartarDialog:b,setShowDescartarDialog:C,showClassificarDialog:E,setShowClassificarDialog:K,showDirecionarClienteDialog:U,setShowDirecionarClienteDialog:z,showHistoricoDialog:H,setShowHistoricoDialog:x,showEditarFazendasDestinoDialog:F,setShowEditarFazendasDestinoDialog:M,congelarData:f,setCongelarData:j,descartarData:D,setDescartarData:T,direcionarClienteData:B,setDirecionarClienteData:W,classificarEmbriao:me,setClassificarEmbriao:ee,descartarEmbriao:ae,setDescartarEmbriao:de,historicoEmbriao:pe,setHistoricoEmbriao:J,pacoteEditandoFazendas:h,setPacoteEditandoFazendas:L,fazendasDestinoSelecionadas:V,setFazendasDestinoSelecionadas:X,historico:se,loadingHistorico:he,submitting:oe,handleCongelarEmMassa:_e,handleDescartarEmMassa:we,handleDirecionarClienteEmMassa:ue,handleSalvarClassificacoesPendentes:re,handleClassificarEmbriao:ie,handleDescartarEmbriao:Te,loadHistorico:Ae,handleSalvarFazendasDestino:Oe,toggleEmbriaoSelecionado:G,selecionarTodosPacote:xe,limparSelecao:le,isEmbriaoSelecionado:ze}}function Aa({value:a,onChange:t,onSubmit:s,onCancel:o,submitting:r,buttonLabel:i}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{children:"Classificação *"}),e.jsxs(oa,{value:a,onValueChange:t,children:[e.jsx(na,{children:e.jsx(ra,{placeholder:"Selecione"})}),e.jsxs(ia,{children:[e.jsx(ge,{value:"BE",children:"BE (Blastocisto Excelente)"}),e.jsx(ge,{value:"BN",children:"BN (Blastocisto Normal)"}),e.jsx(ge,{value:"BX",children:"BX (Blastocisto Regular)"}),e.jsx(ge,{value:"BL",children:"BL (Blastocisto Limitado)"}),e.jsx(ge,{value:"BI",children:"BI (Blastocisto Irregular)"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(P,{onClick:s,className:"flex-1 bg-purple-600 hover:bg-purple-700",disabled:r,children:r?"Salvando...":i}),e.jsx(P,{variant:"outline",onClick:o,disabled:r,children:"Cancelar"})]})]})}var ta=["Enter"," "],_t=["ArrowDown","PageUp","Home"],Ta=["ArrowUp","PageDown","End"],wt=[..._t,...Ta],Ct={ltr:[...ta,"ArrowRight"],rtl:[...ta,"ArrowLeft"]},jt={ltr:["ArrowLeft"],rtl:["ArrowRight"]},He="Menu",[$e,bt,Nt]=Ls(He),[Ne,Oa]=Na(He,[Nt,Da,ya]),We=Da(),Fa=ya(),[Dt,De]=Ne(He),[Et,Ve]=Ne(He),Ba=a=>{const{__scopeMenu:t,open:s=!1,children:o,dir:r,onOpenChange:i,modal:d=!0}=a,l=We(t),[g,_]=c.useState(null),p=c.useRef(!1),u=Ea(i),v=Gs(r);return c.useEffect(()=>{const b=()=>{p.current=!0,document.addEventListener("pointerdown",C,{capture:!0,once:!0}),document.addEventListener("pointermove",C,{capture:!0,once:!0})},C=()=>p.current=!1;return document.addEventListener("keydown",b,{capture:!0}),()=>{document.removeEventListener("keydown",b,{capture:!0}),document.removeEventListener("pointerdown",C,{capture:!0}),document.removeEventListener("pointermove",C,{capture:!0})}},[]),e.jsx(Ps,{...l,children:e.jsx(Dt,{scope:t,open:s,onOpenChange:u,content:g,onContentChange:_,children:e.jsx(Et,{scope:t,onClose:c.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:p,dir:v,modal:d,children:o})})})};Ba.displayName=He;var Mt="MenuAnchor",la=c.forwardRef((a,t)=>{const{__scopeMenu:s,...o}=a,r=We(s);return e.jsx(Is,{...r,...o,ref:t})});la.displayName=Mt;var da="MenuPortal",[St,La]=Ne(da,{forceMount:void 0}),Ga=a=>{const{__scopeMenu:t,forceMount:s,children:o,container:r}=a,i=De(da,t);return e.jsx(St,{scope:t,forceMount:s,children:e.jsx(Ye,{present:s||i.open,children:e.jsx(Ys,{asChild:!0,container:r,children:o})})})};Ga.displayName=da;var ce="MenuContent",[yt,ua]=Ne(ce),$a=c.forwardRef((a,t)=>{const s=La(ce,a.__scopeMenu),{forceMount:o=s.forceMount,...r}=a,i=De(ce,a.__scopeMenu),d=Ve(ce,a.__scopeMenu);return e.jsx($e.Provider,{scope:a.__scopeMenu,children:e.jsx(Ye,{present:o||i.open,children:e.jsx($e.Slot,{scope:a.__scopeMenu,children:d.modal?e.jsx(Rt,{...r,ref:t}):e.jsx(Pt,{...r,ref:t})})})})}),Rt=c.forwardRef((a,t)=>{const s=De(ce,a.__scopeMenu),o=c.useRef(null),r=Ue(t,o);return c.useEffect(()=>{const i=o.current;if(i)return Ws(i)},[]),e.jsx(fa,{...a,ref:r,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:k(a.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Pt=c.forwardRef((a,t)=>{const s=De(ce,a.__scopeMenu);return e.jsx(fa,{...a,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),It=zs("MenuContent.ScrollLock"),fa=c.forwardRef((a,t)=>{const{__scopeMenu:s,loop:o=!1,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:d,disableOutsidePointerEvents:l,onEntryFocus:g,onEscapeKeyDown:_,onPointerDownOutside:p,onFocusOutside:u,onInteractOutside:v,onDismiss:b,disableOutsideScroll:C,...E}=a,K=De(ce,s),U=Ve(ce,s),z=We(s),H=Fa(s),x=bt(s),[F,M]=c.useState(null),f=c.useRef(null),j=Ue(t,f,K.onContentChange),D=c.useRef(0),T=c.useRef(""),B=c.useRef(0),W=c.useRef(null),me=c.useRef("right"),ee=c.useRef(0),ae=C?Zs:c.Fragment,de=C?{as:It,allowPinchZoom:!0}:void 0,pe=h=>{var oe,O;const L=T.current+h,V=x().filter(G=>!G.disabled),X=document.activeElement,se=(oe=V.find(G=>G.ref.current===X))==null?void 0:oe.textValue,te=V.map(G=>G.textValue),he=Ut(te,L,se),Z=(O=V.find(G=>G.textValue===he))==null?void 0:O.ref.current;(function G(xe){T.current=xe,window.clearTimeout(D.current),xe!==""&&(D.current=window.setTimeout(()=>G(""),1e3))})(L),Z&&setTimeout(()=>Z.focus())};c.useEffect(()=>()=>window.clearTimeout(D.current),[]),Js();const J=c.useCallback(h=>{var V,X;return me.current===((V=W.current)==null?void 0:V.side)&&Vt(h,(X=W.current)==null?void 0:X.area)},[]);return e.jsx(yt,{scope:s,searchRef:T,onItemEnter:c.useCallback(h=>{J(h)&&h.preventDefault()},[J]),onItemLeave:c.useCallback(h=>{var L;J(h)||((L=f.current)==null||L.focus(),M(null))},[J]),onTriggerLeave:c.useCallback(h=>{J(h)&&h.preventDefault()},[J]),pointerGraceTimerRef:B,onPointerGraceIntentChange:c.useCallback(h=>{W.current=h},[]),children:e.jsx(ae,{...de,children:e.jsx(Qs,{asChild:!0,trapped:r,onMountAutoFocus:k(i,h=>{var L;h.preventDefault(),(L=f.current)==null||L.focus({preventScroll:!0})}),onUnmountAutoFocus:d,children:e.jsx(As,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:_,onPointerDownOutside:p,onFocusOutside:u,onInteractOutside:v,onDismiss:b,children:e.jsx(st,{asChild:!0,...H,dir:U.dir,orientation:"vertical",loop:o,currentTabStopId:F,onCurrentTabStopIdChange:M,onEntryFocus:k(g,h=>{U.isUsingKeyboardRef.current||h.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Ts,{role:"menu","aria-orientation":"vertical","data-state":os(K.open),"data-radix-menu-content":"",dir:U.dir,...z,...E,ref:j,style:{outline:"none",...E.style},onKeyDown:k(E.onKeyDown,h=>{const V=h.target.closest("[data-radix-menu-content]")===h.currentTarget,X=h.ctrlKey||h.altKey||h.metaKey,se=h.key.length===1;V&&(h.key==="Tab"&&h.preventDefault(),!X&&se&&pe(h.key));const te=f.current;if(h.target!==te||!wt.includes(h.key))return;h.preventDefault();const Z=x().filter(oe=>!oe.disabled).map(oe=>oe.ref.current);Ta.includes(h.key)&&Z.reverse(),$t(Z)}),onBlur:k(a.onBlur,h=>{h.currentTarget.contains(h.target)||(window.clearTimeout(D.current),T.current="")}),onPointerMove:k(a.onPointerMove,Ke(h=>{const L=h.target,V=ee.current!==h.clientX;if(h.currentTarget.contains(L)&&V){const X=h.clientX>ee.current?"right":"left";me.current=X,ee.current=h.clientX}}))})})})})})})});$a.displayName=ce;var kt="MenuGroup",ma=c.forwardRef((a,t)=>{const{__scopeMenu:s,...o}=a;return e.jsx(ye.div,{role:"group",...o,ref:t})});ma.displayName=kt;var zt="MenuLabel",Ka=c.forwardRef((a,t)=>{const{__scopeMenu:s,...o}=a;return e.jsx(ye.div,{...o,ref:t})});Ka.displayName=zt;var qe="MenuItem",ba="menu.itemSelect",Je=c.forwardRef((a,t)=>{const{disabled:s=!1,onSelect:o,...r}=a,i=c.useRef(null),d=Ve(qe,a.__scopeMenu),l=ua(qe,a.__scopeMenu),g=Ue(t,i),_=c.useRef(!1),p=()=>{const u=i.current;if(!s&&u){const v=new CustomEvent(ba,{bubbles:!0,cancelable:!0});u.addEventListener(ba,b=>o==null?void 0:o(b),{once:!0}),ks(u,v),v.defaultPrevented?_.current=!1:d.onClose()}};return e.jsx(Ua,{...r,ref:g,disabled:s,onClick:k(a.onClick,p),onPointerDown:u=>{var v;(v=a.onPointerDown)==null||v.call(a,u),_.current=!0},onPointerUp:k(a.onPointerUp,u=>{var v;_.current||(v=u.currentTarget)==null||v.click()}),onKeyDown:k(a.onKeyDown,u=>{const v=l.searchRef.current!=="";s||v&&u.key===" "||ta.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});Je.displayName=qe;var Ua=c.forwardRef((a,t)=>{const{__scopeMenu:s,disabled:o=!1,textValue:r,...i}=a,d=ua(qe,s),l=Fa(s),g=c.useRef(null),_=Ue(t,g),[p,u]=c.useState(!1),[v,b]=c.useState("");return c.useEffect(()=>{const C=g.current;C&&b((C.textContent??"").trim())},[i.children]),e.jsx($e.ItemSlot,{scope:s,disabled:o,textValue:r??v,children:e.jsx(at,{asChild:!0,...l,focusable:!o,children:e.jsx(ye.div,{role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0,...i,ref:_,onPointerMove:k(a.onPointerMove,Ke(C=>{o?d.onItemLeave(C):(d.onItemEnter(C),C.defaultPrevented||C.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:k(a.onPointerLeave,Ke(C=>d.onItemLeave(C))),onFocus:k(a.onFocus,()=>u(!0)),onBlur:k(a.onBlur,()=>u(!1))})})})}),At="MenuCheckboxItem",Ha=c.forwardRef((a,t)=>{const{checked:s=!1,onCheckedChange:o,...r}=a;return e.jsx(Wa,{scope:a.__scopeMenu,checked:s,children:e.jsx(Je,{role:"menuitemcheckbox","aria-checked":Xe(s)?"mixed":s,...r,ref:t,"data-state":ha(s),onSelect:k(r.onSelect,()=>o==null?void 0:o(Xe(s)?!0:!s),{checkForDefaultPrevented:!1})})})});Ha.displayName=At;var Va="MenuRadioGroup",[Tt,Ot]=Ne(Va,{value:void 0,onValueChange:()=>{}}),qa=c.forwardRef((a,t)=>{const{value:s,onValueChange:o,...r}=a,i=Ea(o);return e.jsx(Tt,{scope:a.__scopeMenu,value:s,onValueChange:i,children:e.jsx(ma,{...r,ref:t})})});qa.displayName=Va;var Xa="MenuRadioItem",Ya=c.forwardRef((a,t)=>{const{value:s,...o}=a,r=Ot(Xa,a.__scopeMenu),i=s===r.value;return e.jsx(Wa,{scope:a.__scopeMenu,checked:i,children:e.jsx(Je,{role:"menuitemradio","aria-checked":i,...o,ref:t,"data-state":ha(i),onSelect:k(o.onSelect,()=>{var d;return(d=r.onValueChange)==null?void 0:d.call(r,s)},{checkForDefaultPrevented:!1})})})});Ya.displayName=Xa;var pa="MenuItemIndicator",[Wa,Ft]=Ne(pa,{checked:!1}),Ja=c.forwardRef((a,t)=>{const{__scopeMenu:s,forceMount:o,...r}=a,i=Ft(pa,s);return e.jsx(Ye,{present:o||Xe(i.checked)||i.checked===!0,children:e.jsx(ye.span,{...r,ref:t,"data-state":ha(i.checked)})})});Ja.displayName=pa;var Bt="MenuSeparator",Za=c.forwardRef((a,t)=>{const{__scopeMenu:s,...o}=a;return e.jsx(ye.div,{role:"separator","aria-orientation":"horizontal",...o,ref:t})});Za.displayName=Bt;var Lt="MenuArrow",Qa=c.forwardRef((a,t)=>{const{__scopeMenu:s,...o}=a,r=We(s);return e.jsx(Os,{...r,...o,ref:t})});Qa.displayName=Lt;var Gt="MenuSub",[gn,es]=Ne(Gt),Le="MenuSubTrigger",as=c.forwardRef((a,t)=>{const s=De(Le,a.__scopeMenu),o=Ve(Le,a.__scopeMenu),r=es(Le,a.__scopeMenu),i=ua(Le,a.__scopeMenu),d=c.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:g}=i,_={__scopeMenu:a.__scopeMenu},p=c.useCallback(()=>{d.current&&window.clearTimeout(d.current),d.current=null},[]);return c.useEffect(()=>p,[p]),c.useEffect(()=>{const u=l.current;return()=>{window.clearTimeout(u),g(null)}},[l,g]),e.jsx(la,{asChild:!0,..._,children:e.jsx(Ua,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":r.contentId,"data-state":os(s.open),...a,ref:Ma(t,r.onTriggerChange),onClick:u=>{var v;(v=a.onClick)==null||v.call(a,u),!(a.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:k(a.onPointerMove,Ke(u=>{i.onItemEnter(u),!u.defaultPrevented&&!a.disabled&&!s.open&&!d.current&&(i.onPointerGraceIntentChange(null),d.current=window.setTimeout(()=>{s.onOpenChange(!0),p()},100))})),onPointerLeave:k(a.onPointerLeave,Ke(u=>{var b,C;p();const v=(b=s.content)==null?void 0:b.getBoundingClientRect();if(v){const E=(C=s.content)==null?void 0:C.dataset.side,K=E==="right",U=K?-5:5,z=v[K?"left":"right"],H=v[K?"right":"left"];i.onPointerGraceIntentChange({area:[{x:u.clientX+U,y:u.clientY},{x:z,y:v.top},{x:H,y:v.top},{x:H,y:v.bottom},{x:z,y:v.bottom}],side:E}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(u),u.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:k(a.onKeyDown,u=>{var b;const v=i.searchRef.current!=="";a.disabled||v&&u.key===" "||Ct[o.dir].includes(u.key)&&(s.onOpenChange(!0),(b=s.content)==null||b.focus(),u.preventDefault())})})})});as.displayName=Le;var ss="MenuSubContent",ts=c.forwardRef((a,t)=>{const s=La(ce,a.__scopeMenu),{forceMount:o=s.forceMount,...r}=a,i=De(ce,a.__scopeMenu),d=Ve(ce,a.__scopeMenu),l=es(ss,a.__scopeMenu),g=c.useRef(null),_=Ue(t,g);return e.jsx($e.Provider,{scope:a.__scopeMenu,children:e.jsx(Ye,{present:o||i.open,children:e.jsx($e.Slot,{scope:a.__scopeMenu,children:e.jsx(fa,{id:l.contentId,"aria-labelledby":l.triggerId,...r,ref:_,align:"start",side:d.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:p=>{var u;d.isUsingKeyboardRef.current&&((u=g.current)==null||u.focus()),p.preventDefault()},onCloseAutoFocus:p=>p.preventDefault(),onFocusOutside:k(a.onFocusOutside,p=>{p.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:k(a.onEscapeKeyDown,p=>{d.onClose(),p.preventDefault()}),onKeyDown:k(a.onKeyDown,p=>{var b;const u=p.currentTarget.contains(p.target),v=jt[d.dir].includes(p.key);u&&v&&(i.onOpenChange(!1),(b=l.trigger)==null||b.focus(),p.preventDefault())})})})})})});ts.displayName=ss;function os(a){return a?"open":"closed"}function Xe(a){return a==="indeterminate"}function ha(a){return Xe(a)?"indeterminate":a?"checked":"unchecked"}function $t(a){const t=document.activeElement;for(const s of a)if(s===t||(s.focus(),document.activeElement!==t))return}function Kt(a,t){return a.map((s,o)=>a[(t+o)%a.length])}function Ut(a,t,s){const r=t.length>1&&Array.from(t).every(_=>_===t[0])?t[0]:t,i=s?a.indexOf(s):-1;let d=Kt(a,Math.max(i,0));r.length===1&&(d=d.filter(_=>_!==s));const g=d.find(_=>_.toLowerCase().startsWith(r.toLowerCase()));return g!==s?g:void 0}function Ht(a,t){const{x:s,y:o}=a;let r=!1;for(let i=0,d=t.length-1;i<t.length;d=i++){const l=t[i],g=t[d],_=l.x,p=l.y,u=g.x,v=g.y;p>o!=v>o&&s<(u-_)*(o-p)/(v-p)+_&&(r=!r)}return r}function Vt(a,t){if(!t)return!1;const s={x:a.clientX,y:a.clientY};return Ht(s,t)}function Ke(a){return t=>t.pointerType==="mouse"?a(t):void 0}var qt=Ba,Xt=la,Yt=Ga,Wt=$a,Jt=ma,Zt=Ka,Qt=Je,eo=Ha,ao=qa,so=Ya,to=Ja,oo=Za,no=Qa,ro=as,io=ts,Ze="DropdownMenu",[co,vn]=Na(Ze,[Oa]),Q=Oa(),[lo,ns]=co(Ze),rs=a=>{const{__scopeDropdownMenu:t,children:s,dir:o,open:r,defaultOpen:i,onOpenChange:d,modal:l=!0}=a,g=Q(t),_=c.useRef(null),[p,u]=et({prop:r,defaultProp:i??!1,onChange:d,caller:Ze});return e.jsx(lo,{scope:t,triggerId:ga(),triggerRef:_,contentId:ga(),open:p,onOpenChange:u,onOpenToggle:c.useCallback(()=>u(v=>!v),[u]),modal:l,children:e.jsx(qt,{...g,open:p,onOpenChange:u,dir:o,modal:l,children:s})})};rs.displayName=Ze;var is="DropdownMenuTrigger",cs=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,disabled:o=!1,...r}=a,i=ns(is,s),d=Q(s);return e.jsx(Xt,{asChild:!0,...d,children:e.jsx(ye.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":o?"":void 0,disabled:o,...r,ref:Ma(t,i.triggerRef),onPointerDown:k(a.onPointerDown,l=>{!o&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:k(a.onKeyDown,l=>{o||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});cs.displayName=is;var uo="DropdownMenuPortal",ls=a=>{const{__scopeDropdownMenu:t,...s}=a,o=Q(t);return e.jsx(Yt,{...o,...s})};ls.displayName=uo;var ds="DropdownMenuContent",us=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=ns(ds,s),i=Q(s),d=c.useRef(!1);return e.jsx(Wt,{id:r.contentId,"aria-labelledby":r.triggerId,...i,...o,ref:t,onCloseAutoFocus:k(a.onCloseAutoFocus,l=>{var g;d.current||(g=r.triggerRef.current)==null||g.focus(),d.current=!1,l.preventDefault()}),onInteractOutside:k(a.onInteractOutside,l=>{const g=l.detail.originalEvent,_=g.button===0&&g.ctrlKey===!0,p=g.button===2||_;(!r.modal||p)&&(d.current=!0)}),style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});us.displayName=ds;var fo="DropdownMenuGroup",mo=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(Jt,{...r,...o,ref:t})});mo.displayName=fo;var po="DropdownMenuLabel",fs=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(Zt,{...r,...o,ref:t})});fs.displayName=po;var ho="DropdownMenuItem",ms=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(Qt,{...r,...o,ref:t})});ms.displayName=ho;var xo="DropdownMenuCheckboxItem",ps=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(eo,{...r,...o,ref:t})});ps.displayName=xo;var go="DropdownMenuRadioGroup",vo=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(ao,{...r,...o,ref:t})});vo.displayName=go;var _o="DropdownMenuRadioItem",hs=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(so,{...r,...o,ref:t})});hs.displayName=_o;var wo="DropdownMenuItemIndicator",xs=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(to,{...r,...o,ref:t})});xs.displayName=wo;var Co="DropdownMenuSeparator",gs=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(oo,{...r,...o,ref:t})});gs.displayName=Co;var jo="DropdownMenuArrow",bo=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(no,{...r,...o,ref:t})});bo.displayName=jo;var No="DropdownMenuSubTrigger",vs=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(ro,{...r,...o,ref:t})});vs.displayName=No;var Do="DropdownMenuSubContent",_s=c.forwardRef((a,t)=>{const{__scopeDropdownMenu:s,...o}=a,r=Q(s);return e.jsx(io,{...r,...o,ref:t,style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});_s.displayName=Do;var Eo=rs,Mo=cs,So=ls,ws=us,Cs=fs,js=ms,bs=ps,Ns=hs,Ds=xs,Es=gs,Ms=vs,Ss=_s;const yo=Eo,Ro=Mo,Po=c.forwardRef(({className:a,inset:t,children:s,...o},r)=>e.jsxs(Ms,{ref:r,className:ve("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",a),...o,children:[s,e.jsx(Ra,{className:"ml-auto h-4 w-4"})]}));Po.displayName=Ms.displayName;const Io=c.forwardRef(({className:a,...t},s)=>e.jsx(Ss,{ref:s,className:ve("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...t}));Io.displayName=Ss.displayName;const ys=c.forwardRef(({className:a,sideOffset:t=4,...s},o)=>e.jsx(So,{children:e.jsx(ws,{ref:o,sideOffset:t,className:ve("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})}));ys.displayName=ws.displayName;const Ge=c.forwardRef(({className:a,inset:t,...s},o)=>e.jsx(js,{ref:o,className:ve("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",a),...s}));Ge.displayName=js.displayName;const ko=c.forwardRef(({className:a,children:t,checked:s,...o},r)=>e.jsxs(bs,{ref:r,className:ve("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:s,...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ds,{children:e.jsx(aa,{className:"h-4 w-4"})})}),t]}));ko.displayName=bs.displayName;const zo=c.forwardRef(({className:a,children:t,...s},o)=>e.jsxs(Ns,{ref:o,className:ve("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ds,{children:e.jsx(ft,{className:"h-2 w-2 fill-current"})})}),t]}));zo.displayName=Ns.displayName;const Ao=c.forwardRef(({className:a,inset:t,...s},o)=>e.jsx(Cs,{ref:o,className:ve("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",a),...s}));Ao.displayName=Cs.displayName;const Rs=c.forwardRef(({className:a,...t},s)=>e.jsx(Es,{ref:s,className:ve("-mx-1 my-1 h-px bg-muted",a),...t}));Rs.displayName=Es.displayName;function To({pacote:a,embrioesSelecionados:t,paginaAtual:s,pageSize:o,totalSelecionados:r,getClassificacaoAtual:i,onToggleSelecionarEmbriao:d,onSelecionarTodosDaPagina:l,onSetPagina:g,onClassificar:_,onCongelar:p,onDirecionar:u,onDescartar:v}){const b=[...a.embrioes].sort((x,F)=>{const M=x.identificacao||"",f=F.identificacao||"";return M&&f?M.localeCompare(f):M&&!f?-1:!M&&f?1:(x.created_at||"").localeCompare(F.created_at||"")}),C=Math.max(1,Math.ceil(b.length/o)),E=Math.min(s,C),K=(E-1)*o,U=b.slice(K,K+o),z=U.every(x=>t.has(x.id)),H=U.some(x=>t.has(x.id));return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 pb-2 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>l(U),className:"h-8 px-2",children:[z?e.jsx(_a,{className:"w-4 h-4 text-green-600"}):e.jsx(wa,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"ml-2 text-xs",children:z?"Desmarcar":"Selecionar página"})]}),(H||r>0)&&e.jsxs("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded",children:[U.filter(x=>t.has(x.id)).length," selecionados"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsxs("span",{children:[b.length," embriões"]}),e.jsx("span",{className:"mx-1",children:"•"}),e.jsxs("span",{children:["Pág. ",E,"/",C]})]})]}),e.jsx("div",{className:"grid gap-2",children:U.map((x,F)=>{const M=t.has(x.id),f=i(x),j=x.status_atual==="FRESCO",D=x.status_atual==="CONGELADO";return e.jsxs("div",{className:`
                group relative flex flex-col sm:flex-row sm:items-center gap-3 p-3 rounded-lg border transition-all
                ${M?"bg-green-50 border-green-200 shadow-sm":"bg-white border-slate-200 hover:border-slate-300 hover:shadow-sm"}
              `,children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{onClick:()=>d(x.id),className:"flex-shrink-0 p-1 rounded hover:bg-slate-100",children:M?e.jsx(_a,{className:"w-5 h-5 text-green-600"}):e.jsx(wa,{className:"w-5 h-5 text-slate-300 group-hover:text-slate-400"})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[x.identificacao?e.jsx("span",{className:"font-mono text-sm font-medium text-slate-800 truncate",children:x.identificacao}):e.jsx("span",{className:"text-sm text-amber-600 italic",title:"Embrião sem código de rastreabilidade",children:"Sem código"}),e.jsxs("span",{className:"text-xs text-slate-500 sm:hidden",children:[x.doadora_registro||"-"," × ",x.touro_nome||"-"]})]})]}),e.jsx("div",{className:"hidden sm:flex flex-1 items-center gap-4 min-w-0",children:e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-slate-600 truncate",title:x.doadora_registro||"-",children:x.doadora_registro||"-"}),e.jsx("span",{className:"text-slate-400",children:"×"}),e.jsx("span",{className:"text-slate-600 truncate",title:x.touro_nome||"-",children:x.touro_nome||"-"})]})})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap sm:flex-nowrap",children:[f?e.jsx(Me,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200 text-xs",children:f}):e.jsx(Me,{variant:"outline",className:"text-slate-400 border-dashed text-xs",children:"Sem classificação"}),e.jsx(nt,{status:x.status_atual}),x.localizacao_atual&&e.jsx(Me,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200 text-xs hidden lg:inline-flex",children:x.localizacao_atual})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:ml-2",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>_(x),className:"h-8 w-8 p-0 text-purple-600 hover:text-purple-700 hover:bg-purple-50",title:"Classificar",children:e.jsx(sa,{className:"w-4 h-4"})}),j&&f&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>p(x),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Congelar",children:e.jsx(ea,{className:"w-4 h-4"})}),e.jsxs(yo,{children:[e.jsx(Ro,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-slate-500 hover:text-slate-700",children:e.jsx(mt,{className:"w-4 h-4"})})}),e.jsxs(ys,{align:"end",className:"w-48",children:[e.jsxs(Ge,{onClick:()=>_(x),children:[e.jsx(sa,{className:"w-4 h-4 mr-2 text-purple-600"}),"Classificar"]}),j&&e.jsxs(Ge,{onClick:()=>p(x),disabled:!f,className:f?"":"opacity-50",children:[e.jsx(ea,{className:"w-4 h-4 mr-2 text-blue-600"}),"Congelar",!f&&e.jsx("span",{className:"ml-auto text-xs text-slate-400",children:"Classificar primeiro"})]}),D&&!x.cliente_id&&e.jsxs(Ge,{onClick:()=>u(x),children:[e.jsx(Ia,{className:"w-4 h-4 mr-2 text-green-600"}),"Direcionar para cliente"]}),e.jsx(Rs,{}),e.jsxs(Ge,{onClick:()=>v(x),className:"text-red-600 focus:text-red-600 focus:bg-red-50",children:[e.jsx(ka,{className:"w-4 h-4 mr-2"}),"Descartar"]})]})]})]})]},x.id)})}),C>1&&e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Mostrando ",K+1,"-",Math.min(K+o,b.length)," de ",b.length]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>g(Math.max(1,E-1)),disabled:E===1,className:"h-8 w-8 p-0",children:e.jsx(tt,{className:"w-4 h-4"})}),e.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,C)},(x,F)=>{let M;return C<=5||E<=3?M=F+1:E>=C-2?M=C-4+F:M=E-2+F,e.jsx(P,{variant:E===M?"default":"ghost",size:"sm",onClick:()=>g(M),className:"h-8 w-8 p-0 text-xs",children:M},M)})}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>g(Math.min(C,E+1)),disabled:E===C,className:"h-8 w-8 p-0",children:e.jsx(Ra,{className:"w-4 h-4"})})]})]})]})}function Oo({pacote:a,expandido:t,onToggleExpandir:s,onEditarFazendasDestino:o,onDespachar:r,resumoPacote:i,embrioesSelecionados:d,paginaAtual:l,pageSize:g,getClassificacaoAtual:_,onToggleSelecionarEmbriao:p,onSelecionarTodosDaPagina:u,onSetPagina:v,onClassificar:b,onCongelar:C,onDirecionar:E,onDescartar:K}){const U=a.embrioes.filter(j=>d.has(j.id)).length,z=xt(a.data_fecundacao),H=z===7,x=z===8,F=z!==null&&z>8;let M="from-green-500",f="bg-green-50";return x&&(M="from-orange-500",f="bg-orange-50"),F&&(M="from-red-500",f="bg-red-50"),e.jsxs(Vs,{className:"overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:`h-1 bg-gradient-to-r ${M} to-transparent`}),e.jsx(qs,{className:"pb-0",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:s,className:"flex-shrink-0 p-1 rounded-md hover:bg-slate-100 transition-colors mt-0.5",children:t?e.jsx($s,{className:"w-5 h-5 text-slate-500"}):e.jsx(Ks,{className:"w-5 h-5 text-slate-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:a.pacote_info.fazenda_nome||"Fazenda não identificada"}),e.jsx("span",{className:"text-slate-400",children:"→"}),a.fazendas_destino_nomes.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.fazendas_destino_nomes.map((j,D)=>e.jsxs(Me,{variant:"secondary",className:"text-xs font-normal",children:[e.jsx(rt,{className:"w-3 h-3 mr-1"}),j]},D)),e.jsx(P,{variant:"ghost",size:"sm",onClick:o,className:"h-6 w-6 p-0 text-slate-400 hover:text-slate-600",title:"Editar fazendas destino",children:e.jsx(pt,{className:"w-3 h-3"})})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Sem destino definido"}),e.jsx(P,{variant:"ghost",size:"sm",onClick:o,className:"h-6 px-2 text-xs text-blue-600 hover:text-blue-700",children:"Definir"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2 text-xs text-slate-500",children:[a.data_despacho&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ot,{className:"w-3 h-3"}),"Despacho: ",Fs(a.data_despacho)]}),z!==null&&a.frescos>0&&e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full ${f}`,children:[H&&e.jsxs(e.Fragment,{children:[e.jsx(aa,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-green-700 font-medium",children:"D7 - Ideal"})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx(va,{className:"w-3 h-3 text-orange-600 animate-pulse"}),e.jsx("span",{className:"text-orange-700 font-medium",children:"D8 - Último dia!"})]}),F&&e.jsxs(e.Fragment,{children:[e.jsx(va,{className:"w-3 h-3 text-red-600"}),e.jsxs("span",{className:"text-red-700 font-medium",children:["D",z," - Vencido"]})]})]})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 lg:gap-6 pl-9 lg:pl-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.total}),e.jsx("div",{className:"text-xs text-slate-500",children:"embriões"})]}),e.jsxs("div",{className:"flex flex-col gap-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-400"}),e.jsxs("span",{className:"text-slate-600",children:[a.frescos," frescos"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-400"}),e.jsxs("span",{className:"text-slate-600",children:[a.congelados," congelados"]})]}),i.semClassificacao>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-300"}),e.jsxs("span",{className:"text-slate-500",children:[i.semClassificacao," sem classif."]})]})]})]}),e.jsx("div",{className:"flex flex-col gap-2 min-w-[160px]",children:i.todosClassificados?e.jsxs(e.Fragment,{children:[e.jsxs(Me,{variant:"outline",className:"justify-center bg-green-50 text-green-700 border-green-200",children:[e.jsx(aa,{className:"w-3 h-3 mr-1"}),"Todos classificados"]}),a.disponivel_para_transferencia?e.jsxs(Me,{variant:"outline",className:"justify-center bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(Ca,{className:"w-3 h-3 mr-1"}),"Pronto para transferência"]}):e.jsxs(P,{size:"sm",onClick:r,className:"bg-green-600 hover:bg-green-700 text-white h-8",children:[e.jsx(Ca,{className:"w-4 h-4 mr-2"}),"Despachar"]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600 px-1",children:[e.jsx("span",{children:"Classificação"}),e.jsxs("span",{className:"font-medium",children:[i.total-i.semClassificacao,"/",i.total]})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-amber-400 to-amber-500 rounded-full transition-all",style:{width:`${(i.total-i.semClassificacao)/i.total*100}%`}})})]})})]})]})}),t&&e.jsx(Xs,{className:"pt-4",children:e.jsx("div",{className:"border-t pt-4",children:e.jsx(To,{pacote:a,embrioesSelecionados:d,paginaAtual:l,pageSize:g,totalSelecionados:U,getClassificacaoAtual:_,onToggleSelecionarEmbriao:p,onSelecionarTodosDaPagina:u,onSetPagina:v,onClassificar:b,onCongelar:C,onDirecionar:E,onDescartar:K})})})]})}function Fo({selectedCount:a,onClassificar:t,onCongelar:s,onDirecionar:o,onDescartar:r,onCancelar:i}){return e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 animate-in slide-in-from-bottom-5 duration-300",children:e.jsx("div",{className:"bg-white border-t shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1.5 rounded-full",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-medium text-sm",children:[a," selecionado(s)"]})]}),e.jsxs(P,{variant:"ghost",size:"sm",onClick:i,className:"text-slate-500 hover:text-slate-700 h-8",children:[e.jsx(ct,{className:"w-4 h-4 mr-1"}),"Limpar"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-center",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:t,className:"h-9 border-purple-200 text-purple-700 hover:bg-purple-50 hover:text-purple-800",children:[e.jsx(sa,{className:"w-4 h-4 mr-2"}),"Classificar"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:s,className:"h-9 border-blue-200 text-blue-700 hover:bg-blue-50 hover:text-blue-800",children:[e.jsx(ea,{className:"w-4 h-4 mr-2"}),"Congelar"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:o,className:"h-9 border-green-200 text-green-700 hover:bg-green-50 hover:text-green-800",children:[e.jsx(Ia,{className:"w-4 h-4 mr-2"}),"Direcionar"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:r,className:"h-9 border-red-200 text-red-700 hover:bg-red-50 hover:text-red-800",children:[e.jsx(ka,{className:"w-4 h-4 mr-2"}),"Descartar"]})]})]})})})})}function Bo({open:a,onOpenChange:t,embriao:s,classificacao:o,onClassificacaoChange:r,onSubmit:i,submitting:d}){return e.jsx(Re,{open:a,onOpenChange:t,children:e.jsxs(Pe,{className:"max-w-md",children:[e.jsxs(Ie,{children:[e.jsx(ke,{children:"Classificar Embrião"}),e.jsx(ca,{children:(s==null?void 0:s.identificacao)||"Embrião selecionado"})]}),e.jsx(Aa,{value:o,onChange:r,onSubmit:i,onCancel:()=>t(!1),submitting:d,buttonLabel:"Salvar Classificação"})]})})}function Lo({open:a,onOpenChange:t,count:s,classificacao:o,onClassificacaoChange:r,onSubmit:i,submitting:d}){return e.jsx(Re,{open:a,onOpenChange:t,children:e.jsxs(Pe,{className:"max-w-md",children:[e.jsxs(Ie,{children:[e.jsxs(ke,{children:["Classificar ",s," Embrião(ões)"]}),e.jsx(ca,{children:"Mesma classificação para todos"})]}),e.jsx(Aa,{value:o,onChange:r,onSubmit:i,onCancel:()=>t(!1),submitting:d,buttonLabel:`Classificar ${s}`})]})})}function Go({open:a,onOpenChange:t,count:s,data:o,onDataChange:r,onSubmit:i,submitting:d}){return e.jsx(Re,{open:a,onOpenChange:t,children:e.jsxs(Pe,{className:"max-w-md",children:[e.jsx(Ie,{children:e.jsxs(ke,{children:["Congelar ",s," Embrião(ões)"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{children:"Data de Congelamento *"}),e.jsx(Pa,{value:o.data_congelamento,onChange:l=>r({...o,data_congelamento:l||""}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{children:"Localização (Botijão) *"}),e.jsx(dt,{value:o.localizacao_atual,onChange:l=>r({...o,localizacao_atual:l.target.value}),placeholder:"Ex: Botijão 1, Canister A"})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(P,{onClick:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",disabled:d,children:d?"Congelando...":"Congelar"}),e.jsx(P,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"})]})]})]})})}function $o({open:a,onOpenChange:t,count:s,data:o,onDataChange:r,onSubmit:i,submitting:d}){return e.jsx(Re,{open:a,onOpenChange:t,children:e.jsxs(Pe,{className:"max-w-md",children:[e.jsx(Ie,{children:e.jsxs(ke,{children:["Descartar ",s," Embrião(ões)"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{children:"Data de Descarte *"}),e.jsx(Pa,{value:o.data_descarte,onChange:l=>r({...o,data_descarte:l||""}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{children:"Observações / Motivo"}),e.jsx(ut,{value:o.observacoes,onChange:l=>r({...o,observacoes:l.target.value}),placeholder:"Motivo do descarte (opcional)",rows:3})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(P,{onClick:i,className:"flex-1 bg-red-600 hover:bg-red-700",disabled:d,children:d?"Descartando...":"Descartar"}),e.jsx(P,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"})]})]})]})})}function Ko({open:a,onOpenChange:t,clientes:s,data:o,onDataChange:r,onSubmit:i,submitting:d}){return e.jsx(Re,{open:a,onOpenChange:t,children:e.jsxs(Pe,{className:"max-w-md",children:[e.jsx(Ie,{children:e.jsx(ke,{children:"Direcionar para Cliente"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(be,{children:"Cliente *"}),e.jsxs(oa,{value:o.cliente_id,onValueChange:l=>r({cliente_id:l}),children:[e.jsx(na,{children:e.jsx(ra,{placeholder:"Selecione o cliente"})}),e.jsx(ia,{children:s.map(l=>e.jsx(ge,{value:l.id,children:l.nome},l.id))})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(P,{onClick:i,className:"flex-1 bg-green-600 hover:bg-green-700",disabled:d,children:d?"Direcionando...":"Direcionar"}),e.jsx(P,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"})]})]})]})})}function Uo({open:a,onOpenChange:t,pacote:s,fazendas:o,fazendasSelecionadas:r,onFazendasChange:i,onSubmit:d,submitting:l}){const g=(_,p)=>{i(p?[...r,_]:r.filter(u=>u!==_))};return e.jsx(Re,{open:a,onOpenChange:t,children:e.jsxs(Pe,{className:"max-w-md",children:[e.jsxs(Ie,{children:[e.jsx(ke,{children:"Editar Fazendas Destino"}),e.jsx(ca,{children:"Selecione as fazendas destino do pacote"})]}),s&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto border rounded-md p-3",children:o.map(_=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-slate-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:p=>g(_.id,p.target.checked),className:"rounded border-slate-300"}),e.jsx("span",{className:"text-sm",children:_.nome})]},_.id))})}),e.jsxs(lt,{children:[e.jsx(P,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),e.jsx(P,{onClick:d,disabled:l,children:l?"Salvando...":"Salvar"})]})]})})}function _n(){const{toast:a}=Sa(),{embrioes:t,pacotes:s,fazendas:o,clientes:r,loading:i,selectedFazendaDestinoId:d,setSelectedFazendaDestinoId:l,paginasPacotes:g,setPaginasPacotes:_,pageSize:p,loadData:u,loadFazendas:v,loadClientes:b,reloadData:C,getClassificacaoAtual:E,getResumoPacote:K,classificacoesPendentes:U,setClassificacoesPendentes:z}=gt(),{embrioesSelecionados:H,setEmbrioesSelecionados:x,showAcoesEmMassa:F,setShowAcoesEmMassa:M,showCongelarDialog:f,setShowCongelarDialog:j,showDescartarDialog:D,setShowDescartarDialog:T,showClassificarDialog:B,setShowClassificarDialog:W,showDirecionarClienteDialog:me,setShowDirecionarClienteDialog:ee,showEditarFazendasDestinoDialog:ae,setShowEditarFazendasDestinoDialog:de,congelarData:pe,setCongelarData:J,descartarData:h,setDescartarData:L,direcionarClienteData:V,setDirecionarClienteData:X,classificarEmbriao:se,setClassificarEmbriao:te,pacoteEditandoFazendas:he,setPacoteEditandoFazendas:Z,fazendasDestinoSelecionadas:oe,setFazendasDestinoSelecionadas:O,submitting:G,handleCongelarEmMassa:xe,handleDescartarEmMassa:le,handleDirecionarClienteEmMassa:ze,handleSalvarFazendasDestino:Ae,limparSelecao:_e}=vt({embrioes:t,pacotes:s,classificacoesPendentes:U,setClassificacoesPendentes:z,onSuccess:C}),[we,ue]=c.useState(new Set),[re,ie]=c.useState({classificacao:""});c.useEffect(()=>{v(),b()},[v,b]),c.useEffect(()=>{u()},[d,u]);const Te=m=>{ue(A=>{const n=new Set(A);return n.has(m)?n.delete(m):n.add(m),n})},Oe=m=>{x(A=>{const n=new Set(A);return n.has(m)?n.delete(m):n.add(m),M(n.size>0),n})},w=m=>{x(A=>{const n=new Set(A);return m.every(I=>n.has(I.id))?m.forEach(I=>n.delete(I.id)):m.forEach(I=>n.add(I.id)),M(n.size>0),n})},N=m=>g[m]??1,S=(m,A)=>{_(n=>({...n,[m]:A}))},y=()=>{if(!se||!re.classificacao){a({title:"Erro de validação",description:"Classificação é obrigatória",variant:"destructive"});return}z(m=>({...m,[se.id]:re.classificacao})),a({title:"Classificação pendente",description:'Use "Despachar para o campo" para salvar.'}),W(!1),te(null),ie({classificacao:""}),_e()},q=()=>{if(H.size===0||!re.classificacao){a({title:"Erro de validação",description:"Selecione embriões e classificação",variant:"destructive"});return}const m=Array.from(H);z(A=>{const n={...A};return m.forEach(R=>{n[R]=re.classificacao}),n}),a({title:"Classificações pendentes",description:'Use "Despachar para o campo" para salvar.'}),W(!1),ie({classificacao:""}),_e()},fe=async m=>{if(!K(m).todosClassificados){a({title:"Classificação pendente",description:"Classifique todos os embriões antes de despachar.",variant:"destructive"});return}try{const n=new Date().toISOString().split("T")[0],R=m.embrioes.filter(I=>{const Y=E(I);return Y&&Y!==(I.classificacao||"").trim()});R.length>0&&await Promise.all(R.map(I=>$.from("embrioes").update({classificacao:E(I),data_classificacao:n}).eq("id",I.id))),await $.from("lotes_fiv").update({disponivel_para_transferencia:!0}).eq("id",m.lote_fiv_id),a({title:"Pacote despachado",description:"Disponível para transferência."}),z(I=>{const Y={...I};return R.forEach(Ce=>delete Y[Ce.id]),Y}),await C()}catch(n){a({title:"Erro ao despachar",description:n instanceof Error?n.message:"Erro desconhecido",variant:"destructive"})}};return i?e.jsx(Bs,{}):e.jsxs("div",{className:`space-y-6 ${F?"pb-24":""}`,children:[e.jsx(Us,{title:"Estoque de Embriões",description:"Gerenciar pacotes de embriões para transferência, congelamento ou descarte"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 bg-white p-4 rounded-lg border shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{htmlFor:"fazenda_destino",className:"text-sm font-medium whitespace-nowrap",children:"Fazenda Destino:"}),e.jsxs(oa,{value:d||"all",onValueChange:m=>l(m==="all"?"":m),children:[e.jsx(na,{className:"w-[200px] sm:w-[280px]",children:e.jsx(ra,{placeholder:"Todas as fazendas"})}),e.jsxs(ia,{children:[e.jsx(ge,{value:"all",children:"Todas as fazendas"}),o.map(m=>e.jsx(ge,{value:m.id,children:m.nome},m.id))]})]})]}),e.jsxs("div",{className:"text-sm text-slate-500",children:[s.length," pacote(s) encontrado(s)"]})]}),s.length===0?e.jsx(Hs,{title:"Nenhum pacote encontrado",description:"Selecione outra fazenda ou verifique se há pacotes disponíveis.",action:d?e.jsx(P,{variant:"outline",onClick:()=>l(""),children:"Limpar filtro"}):void 0}):e.jsx("div",{className:"space-y-4",children:s.map(m=>e.jsx(Oo,{pacote:m,expandido:we.has(m.id),onToggleExpandir:()=>Te(m.id),onEditarFazendasDestino:()=>{Z(m),O([...m.fazendas_destino_ids]),de(!0)},onDespachar:()=>fe(m),resumoPacote:K(m),embrioesSelecionados:H,paginaAtual:N(m.id),pageSize:p,getClassificacaoAtual:E,onToggleSelecionarEmbriao:Oe,onSelecionarTodosDaPagina:w,onSetPagina:A=>S(m.id,A),onClassificar:A=>{te(A),ie({classificacao:E(A)||""}),W(!0)},onCongelar:A=>{if(!E(A)){a({title:"Classificação obrigatória",description:"Classifique o embrião primeiro.",variant:"destructive"});return}x(new Set([A.id])),j(!0)},onDirecionar:A=>{x(new Set([A.id])),X({cliente_id:""}),ee(!0)},onDescartar:A=>{x(new Set([A.id])),L({data_descarte:new Date().toISOString().split("T")[0],observacoes:""}),T(!0)}},m.id))}),F&&e.jsx(Fo,{selectedCount:H.size,onClassificar:()=>{ie({classificacao:""}),W(!0)},onCongelar:()=>{J({data_congelamento:new Date().toISOString().split("T")[0],localizacao_atual:""}),j(!0)},onDirecionar:()=>{X({cliente_id:""}),ee(!0)},onDescartar:()=>{L({data_descarte:new Date().toISOString().split("T")[0],observacoes:""}),T(!0)},onCancelar:_e}),e.jsx(Bo,{open:B&&!!se,onOpenChange:m=>{m||(W(!1),te(null))},embriao:se,classificacao:re.classificacao,onClassificacaoChange:m=>ie({classificacao:m}),onSubmit:y,submitting:G}),e.jsx(Lo,{open:B&&!se&&H.size>0,onOpenChange:m=>!m&&W(!1),count:H.size,classificacao:re.classificacao,onClassificacaoChange:m=>ie({classificacao:m}),onSubmit:q,submitting:G}),e.jsx(Go,{open:f,onOpenChange:j,count:H.size,data:pe,onDataChange:J,onSubmit:xe,submitting:G}),e.jsx($o,{open:D,onOpenChange:T,count:H.size,data:h,onDataChange:L,onSubmit:le,submitting:G}),e.jsx(Ko,{open:me,onOpenChange:ee,clientes:r,data:V,onDataChange:X,onSubmit:()=>ze(r),submitting:G}),e.jsx(Uo,{open:ae,onOpenChange:m=>{de(m),m||Z(null)},pacote:he,fazendas:o,fazendasSelecionadas:oe,onFazendasChange:O,onSubmit:Ae,submitting:G})]})}export{_n as default};
