import{e as Xa,f as Ya,r as h,s as x,j as a,a as ae,B as N,g as ee}from"./index-DM5u2d-F.js";import{C as va,a as xa,b as ja,d as ga}from"./card-B_EQ6x91.js";import{T as se,a as re,b as K,c as T,d as oe,e as E}from"./table-CEKyj1ed.js";import{D as Q,a as ie,b as W,c as X,d as Y,e as aa}from"./dialog-2y4jBKyr.js";import{A as fa,a as _a,b as ba,c as Na,d as ya,e as Ca,f as Aa,g as Da}from"./alert-dialog-DtLfiadJ.js";import{I as t}from"./input-CtUEWea1.js";import{L as r}from"./label-Bhhf9ayq.js";import{T as ea}from"./textarea-Kj1o8r55.js";import{S as wa,a as Ea,b as Sa,c as za,d as sa}from"./select-B_NoJ61H.js";import{T as te,a as ne,b as Ta,c as Ia}from"./tabs-mOzZlruc.js";import{B as Oa}from"./badge-D_AVhbx8.js";import{P as de}from"./PageHeader-JgO8x5IE.js";import{E as ce}from"./EmptyState-ChaxWsz8.js";import{u as le}from"./use-toast-BOUGyrIz.js";import{A as he}from"./arrow-left-CH9vqVt5.js";import{L as pe}from"./lock-C7PcKBaO.js";import{S as Fa}from"./square-pen-Cfxri2C7.js";import{P as me}from"./plus-DJrruxx9.js";import"./index-CWb7Yp_3.js";import"./index-sCsFC1oc.js";import"./x-DsJYRTDR.js";import"./index-ClZPXJQX.js";import"./index-BEVMOrkK.js";import"./check-Y5eEMkO8.js";import"./index-C0gH1jj7.js";function Ve(){const{id:b}=Xa(),M=Ya(),{toast:d}=le(),[Ra,ra]=h.useState(!0),[u,g]=h.useState(!1),[o,qa]=h.useState(null),[oa,Pa]=h.useState(""),[ia,ta]=h.useState([]),[C,na]=h.useState([]),[$,Ha]=h.useState([]),F=h.useRef(!1),[B,da]=h.useState(!1),[ue,ka]=h.useState(!1),[Va,J]=h.useState(!1),[La,P]=h.useState(!1),[D,H]=h.useState(null),[Ma,k]=h.useState(!1),[ca,Z]=h.useState(null),[$a,V]=h.useState(!1),[S,G]=h.useState({veterinario_responsavel:"",tecnico_responsavel:""}),[s,c]=h.useState({doadora_id:"",horario_aspiracao:"",hora_final:"",atresicos:"",degenerados:"",expandidos:"",desnudos:"",viaveis:"",recomendacao_touro:"",observacoes:""}),[f,R]=h.useState({registro:"",raca:"",racaCustom:""}),[n,y]=h.useState({horario_aspiracao:"",hora_final:"",atresicos:"",degenerados:"",expandidos:"",desnudos:"",viaveis:"",recomendacao_touro:"",observacoes:""}),Ba=["Holandesa","Jersey","Gir","Girolando"],[L,la]=h.useState("");h.useEffect(()=>{b&&I()},[b]);const I=async()=>{try{ra(!0);const{data:e,error:i}=await x.from("pacotes_aspiracao").select("*").eq("id",b).single();if(i)throw i;qa(e),G({veterinario_responsavel:e.veterinario_responsavel||"",tecnico_responsavel:e.tecnico_responsavel||""});const{data:p,error:l}=await x.from("fazendas").select("nome").eq("id",e.fazenda_id).single();if(l)throw l;Pa(p.nome);const{data:m,error:j}=await x.from("pacotes_aspiracao_fazendas_destino").select("fazenda_destino_id").eq("pacote_aspiracao_id",b);if(!m||m.length===0){if(e.fazenda_destino_id){const{data:_,error:v}=await x.from("fazendas").select("nome").eq("id",e.fazenda_destino_id).single();!v&&_&&ta([_.nome])}}else{const _=m.map(O=>O.fazenda_destino_id),{data:v,error:A}=await x.from("fazendas").select("id, nome").in("id",_);if(!A&&v){const O=v.map(U=>U.nome).filter(Boolean);ta(O)}}await Ja(),e.status==="EM_ANDAMENTO"&&await ha(e.fazenda_id)}catch(e){d({title:"Erro ao carregar dados",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{ra(!1)}},Ja=async()=>{try{const{data:e,error:i}=await x.from("aspiracoes_doadoras").select("*").eq("pacote_aspiracao_id",b).order("created_at",{ascending:!0});if(i)throw i;if(!e||e.length===0){na([]);return}const p=e.map(v=>v.doadora_id),{data:l,error:m}=await x.from("doadoras").select("id, registro, nome").in("id",p);if(m)throw m;const j=new Map((l==null?void 0:l.map(v=>[v.id,v]))||[]),_=e.map(v=>{const A=j.get(v.doadora_id);return{...v,doadora_nome:A==null?void 0:A.nome,doadora_registro:A==null?void 0:A.registro}});na(_)}catch{}},ha=async e=>{try{const{data:i,error:p}=await x.from("aspiracoes_doadoras").select("doadora_id").eq("pacote_aspiracao_id",b),l=new Set((i==null?void 0:i.map(v=>v.doadora_id))||[]),{data:m,error:j}=await x.from("doadoras").select("id, registro, nome").eq("fazenda_id",e).order("registro",{ascending:!0});if(j)throw j;const _=(m||[]).filter(v=>!l.has(v.id));Ha(_)}catch{}},z=e=>{const i=parseInt(e.atresicos)||0,p=parseInt(e.degenerados)||0,l=parseInt(e.expandidos)||0,m=parseInt(e.desnudos)||0,j=parseInt(e.viaveis)||0;return i+p+l+m+j},q=C.reduce((e,i)=>e+(i.total_oocitos||0),0),pa=(e,i)=>{if(!e)return"";const[p,l]=e.split(":").map(Number),m=p*60+l+i*60,j=Math.floor(m/60)%24,_=m%60;return`${String(j).padStart(2,"0")}:${String(_).padStart(2,"0")}`};h.useEffect(()=>{if(B&&o)if(ha(o.fazenda_id),C.length>0){const e=C[C.length-1];e.hora_final&&c(i=>({...i,horario_aspiracao:e.hora_final||"",hora_final:pa(e.hora_final||"",1)}))}else o!=null&&o.horario_inicio&&c(e=>({...e,horario_aspiracao:o.horario_inicio||"",hora_final:pa(o.horario_inicio||"",1)}))},[B,C,o]);const Za=async()=>{if(u||F.current)return;if(!s.doadora_id){d({title:"Erro",description:"Selecione uma doadora",variant:"destructive"});return}if(!s.hora_final.trim()){d({title:"Erro de validação",description:"Hora final é obrigatória",variant:"destructive"});return}if(!(o!=null&&o.veterinario_responsavel)||!(o!=null&&o.tecnico_responsavel)){d({title:"Erro de validação",description:"A aspiração deve ter veterinário e técnico responsáveis preenchidos. Por favor, edite a aspiração primeiro.",variant:"destructive"});return}if(C.find(p=>p.doadora_id===s.doadora_id)){d({title:"Erro",description:"Esta doadora já foi aspirada nesta aspiração",variant:"destructive"});return}if(z(s)===0){Z("add"),k(!0);return}await ma()},ma=async()=>{if(!(u||F.current))try{F.current=!0,g(!0);const e=z(s),i={pacote_aspiracao_id:b,doadora_id:s.doadora_id,fazenda_id:o.fazenda_id,data_aspiracao:o.data_aspiracao,horario_aspiracao:s.horario_aspiracao||null,hora_final:s.hora_final,atresicos:parseInt(s.atresicos)||0,degenerados:parseInt(s.degenerados)||0,expandidos:parseInt(s.expandidos)||0,desnudos:parseInt(s.desnudos)||0,viaveis:parseInt(s.viaveis)||0,total_oocitos:e,veterinario_responsavel:o.veterinario_responsavel,tecnico_responsavel:o.tecnico_responsavel,recomendacao_touro:s.recomendacao_touro.trim()||null,observacoes:s.observacoes.trim()||null},{error:p}=await x.from("aspiracoes_doadoras").insert([i]);if(p){if(p.code==="23505"){d({title:"Erro",description:"Esta doadora já foi aspirada nesta aspiração",variant:"destructive"}),g(!1),F.current=!1,I();return}throw p}const l=q+e;await x.from("pacotes_aspiracao").update({total_oocitos:l}).eq("id",b),d({title:"Doadora adicionada",description:"Doadora adicionada à aspiração com sucesso"}),da(!1),c({doadora_id:"",horario_aspiracao:"",hora_final:"",atresicos:"",degenerados:"",expandidos:"",desnudos:"",viaveis:"",recomendacao_touro:"",observacoes:""}),I()}catch(e){d({title:"Erro ao adicionar doadora",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{g(!1),F.current=!1}},Ga=async()=>{if(!f.registro.trim()){d({title:"Erro de validação",description:"Registro é obrigatório",variant:"destructive"});return}if(!(L==="Outra"?f.racaCustom.trim():f.raca.trim())){d({title:"Erro de validação",description:"Raça é obrigatória",variant:"destructive"});return}if(!s.hora_final.trim()){d({title:"Erro de validação",description:"Hora final é obrigatória",variant:"destructive"});return}if(!(o!=null&&o.veterinario_responsavel)||!(o!=null&&o.tecnico_responsavel)){d({title:"Erro de validação",description:"A aspiração deve ter veterinário e técnico responsáveis preenchidos. Por favor, edite a aspiração primeiro.",variant:"destructive"});return}if(z(s)===0){Z("create"),k(!0);return}await ua()},ua=async()=>{try{g(!0);const e=L==="Outra"?f.racaCustom.trim():f.raca.trim(),i=f.registro.trim().toUpperCase(),{data:p,error:l}=await x.from("doadoras").select("id, registro, raca").ilike("registro",i).eq("raca",e);if(l&&l.code!=="PGRST116")throw l;if(p&&p.length>0){d({title:"Erro",description:`Já existe uma doadora com o registro ${f.registro.trim()} e raça ${e}`,variant:"destructive"}),g(!1);return}const m={fazenda_id:o.fazenda_id,registro:i,raca:e},{data:j,error:_}=await x.from("doadoras").insert([m]).select().single();if(_){if(_.code==="23505"){d({title:"Erro",description:`Já existe uma doadora com o registro ${f.registro.trim()} nesta fazenda`,variant:"destructive"}),g(!1);return}throw _}const v=z(s),A={pacote_aspiracao_id:b,doadora_id:j.id,fazenda_id:o.fazenda_id,data_aspiracao:o.data_aspiracao,horario_aspiracao:s.horario_aspiracao||null,hora_final:s.hora_final,atresicos:parseInt(s.atresicos)||0,degenerados:parseInt(s.degenerados)||0,expandidos:parseInt(s.expandidos)||0,desnudos:parseInt(s.desnudos)||0,viaveis:parseInt(s.viaveis)||0,total_oocitos:v,veterinario_responsavel:o.veterinario_responsavel,tecnico_responsavel:o.tecnico_responsavel,recomendacao_touro:s.recomendacao_touro.trim()||null,observacoes:s.observacoes.trim()||null},{error:O}=await x.from("aspiracoes_doadoras").insert([A]);if(O){if(O.code==="23505"){d({title:"Erro",description:"Esta doadora já foi aspirada nesta aspiração",variant:"destructive"}),g(!1),I();return}throw O}const U=q+v;await x.from("pacotes_aspiracao").update({total_oocitos:U}).eq("id",b),d({title:"Doadora criada e adicionada",description:"Doadora criada e adicionada à aspiração com sucesso"}),ka(!1),R({registro:"",raca:"",racaCustom:""}),la(""),I()}catch(e){d({title:"Erro ao criar doadora",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{g(!1)}},Ua=e=>{var i,p,l,m,j;H(e),y({horario_aspiracao:e.horario_aspiracao||"",hora_final:e.hora_final||"",atresicos:((i=e.atresicos)==null?void 0:i.toString())||"",degenerados:((p=e.degenerados)==null?void 0:p.toString())||"",expandidos:((l=e.expandidos)==null?void 0:l.toString())||"",desnudos:((m=e.desnudos)==null?void 0:m.toString())||"",viaveis:((j=e.viaveis)==null?void 0:j.toString())||"",recomendacao_touro:e.recomendacao_touro||"",observacoes:e.observacoes||""}),P(!0)},Ka=async()=>{if(D){if(!n.hora_final.trim()){d({title:"Erro de validação",description:"Hora final é obrigatória",variant:"destructive"});return}try{g(!0);const e=z(n),i=D.total_oocitos||0,p=e-i,l={horario_aspiracao:n.horario_aspiracao||null,hora_final:n.hora_final,atresicos:parseInt(n.atresicos)||0,degenerados:parseInt(n.degenerados)||0,expandidos:parseInt(n.expandidos)||0,desnudos:parseInt(n.desnudos)||0,viaveis:parseInt(n.viaveis)||0,total_oocitos:e,recomendacao_touro:n.recomendacao_touro.trim()||null,observacoes:n.observacoes.trim()||null},{error:m}=await x.from("aspiracoes_doadoras").update(l).eq("id",D.id);if(m)throw m;const j=q+p;await x.from("pacotes_aspiracao").update({total_oocitos:j}).eq("id",b),d({title:"Aspiração atualizada",description:"Aspiração da doadora atualizada com sucesso"}),P(!1),H(null),I()}catch(e){d({title:"Erro ao atualizar aspiração",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{g(!1)}}},Qa=async()=>{if(!S.veterinario_responsavel.trim()){d({title:"Erro de validação",description:"Veterinário responsável é obrigatório",variant:"destructive"});return}if(!S.tecnico_responsavel.trim()){d({title:"Erro de validação",description:"Técnico responsável é obrigatório",variant:"destructive"});return}try{g(!0);const{error:e}=await x.from("pacotes_aspiracao").update({veterinario_responsavel:S.veterinario_responsavel.trim(),tecnico_responsavel:S.tecnico_responsavel.trim(),updated_at:new Date().toISOString()}).eq("id",b);if(e)throw e;d({title:"Aspiração atualizada",description:"Informações da aspiração atualizadas com sucesso"}),V(!1),I()}catch(e){d({title:"Erro ao atualizar aspiração",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{g(!1)}},Wa=async()=>{try{g(!0);const{error:e}=await x.from("pacotes_aspiracao").update({status:"FINALIZADO",updated_at:new Date().toISOString()}).eq("id",b);if(e)throw e;d({title:"Aspiração finalizada",description:"Aspiração finalizada com sucesso"}),J(!1),M("/aspiracoes")}catch(e){d({title:"Erro ao finalizar aspiração",description:e instanceof Error?e.message:"Erro desconhecido",variant:"destructive"})}finally{g(!1)}};if(Ra)return a.jsx(ae,{});if(!o)return a.jsx("div",{className:"space-y-6",children:a.jsx(ce,{title:"Aspiração não encontrada",description:"Volte para a lista e selecione outra aspiração.",action:a.jsx(N,{onClick:()=>M("/aspiracoes"),variant:"outline",children:"Voltar para Aspirações"})})});const w=o.status==="FINALIZADO";return a.jsxs("div",{className:"space-y-6",children:[a.jsx(de,{title:`Aspiração - ${oa}`,description:w?"Aspiração finalizada":"Gerenciar doadoras da aspiração",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{variant:"outline",size:"icon",onClick:()=>M("/aspiracoes"),children:a.jsx(he,{className:"w-4 h-4"})}),!w&&a.jsxs(N,{onClick:()=>J(!0),disabled:u||C.length===0,className:"bg-blue-600 hover:bg-blue-700",children:[a.jsx(pe,{className:"w-4 h-4 mr-2"}),u?"Finalizando...":"Finalizar Pacote"]})]})}),a.jsxs(va,{children:[a.jsx(xa,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ja,{children:"Informações da Aspiração"}),!w&&a.jsxs(N,{variant:"outline",size:"sm",onClick:()=>V(!0),children:[a.jsx(Fa,{className:"w-4 h-4 mr-2"}),"Editar"]})]})}),a.jsx(ga,{children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(r,{className:"text-slate-500",children:"Fazenda da Aspiração"}),a.jsx("p",{className:"font-medium",children:oa})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx(r,{className:"text-slate-500",children:"Fazendas Destino"}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:ia.length>0?ia.map((e,i)=>a.jsx(Oa,{variant:"outline",className:"font-medium",children:e},i)):a.jsx("p",{className:"font-medium text-slate-400",children:"-"})})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-slate-500",children:"Data da Aspiração"}),a.jsx("p",{className:"font-medium",children:ee(o.data_aspiracao)})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-slate-500",children:"Horário de Início"}),a.jsx("p",{className:"font-medium",children:o.horario_inicio||"-"})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-slate-500",children:"Veterinário Responsável"}),a.jsx("p",{className:"font-medium",children:o.veterinario_responsavel||"-"})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-slate-500",children:"Técnico Responsável"}),a.jsx("p",{className:"font-medium",children:o.tecnico_responsavel||"-"})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-slate-500",children:"Status"}),a.jsx("div",{children:a.jsx(Oa,{variant:w?"default":"secondary",children:w?"FINALIZADO":"EM ANDAMENTO"})})]}),a.jsxs("div",{children:[a.jsx(r,{className:"text-slate-500",children:"Total de Oócitos"}),a.jsx("p",{className:"font-medium text-lg",children:q})]})]})})]}),a.jsxs(va,{children:[a.jsx(xa,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(ja,{children:["Doadoras Aspiradas (",C.length,")"]}),!w&&a.jsxs(Q,{open:B,onOpenChange:e=>{da(e),e||c({doadora_id:"",horario_aspiracao:"",hora_final:"",atresicos:"",degenerados:"",expandidos:"",desnudos:"",viaveis:"",recomendacao_touro:"",observacoes:""})},children:[a.jsx(ie,{asChild:!0,children:a.jsxs(N,{className:"bg-green-600 hover:bg-green-700",children:[a.jsx(me,{className:"w-4 h-4 mr-2"}),"Adicionar Doadora"]})}),a.jsxs(W,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(X,{children:[a.jsx(Y,{children:"Adicionar Doadora à Aspiração"}),a.jsx(aa,{children:"Selecione uma doadora existente ou cadastre uma nova"})]}),a.jsxs(te,{defaultValue:"existing",className:"w-full",children:[a.jsxs(ne,{className:"grid w-full grid-cols-2",children:[a.jsx(Ta,{value:"existing",children:"Doadora Existente"}),a.jsx(Ta,{value:"new",children:"Cadastrar Nova"})]}),a.jsxs(Ia,{value:"existing",className:"space-y-4 mt-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Doadora *"}),a.jsxs(wa,{value:s.doadora_id,onValueChange:e=>c({...s,doadora_id:e}),children:[a.jsx(Ea,{children:a.jsx(Sa,{placeholder:"Selecione uma doadora"})}),a.jsx(za,{children:$.length===0?a.jsx("div",{className:"p-2 text-sm text-slate-500",children:"Nenhuma doadora disponível nesta fazenda"}):$.map(e=>a.jsxs(sa,{value:e.id,children:[e.registro," ",e.nome?`- ${e.nome}`:""]},e.id))})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Horário de Aspiração"}),a.jsx(t,{type:"time",value:s.horario_aspiracao,onChange:e=>c({...s,horario_aspiracao:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Hora Final *"}),a.jsx(t,{type:"time",value:s.hora_final,onChange:e=>c({...s,hora_final:e.target.value}),required:!0})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Contagem de Oócitos"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Atrésicos"}),a.jsx(t,{type:"number",min:"0",value:s.atresicos,onChange:e=>c({...s,atresicos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Degenerados"}),a.jsx(t,{type:"number",min:"0",value:s.degenerados,onChange:e=>c({...s,degenerados:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Expandidos"}),a.jsx(t,{type:"number",min:"0",value:s.expandidos,onChange:e=>c({...s,expandidos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Desnudos"}),a.jsx(t,{type:"number",min:"0",value:s.desnudos,onChange:e=>c({...s,desnudos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Viáveis"}),a.jsx(t,{type:"number",min:"0",value:s.viaveis,onChange:e=>c({...s,viaveis:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Total"}),a.jsx(t,{value:z(s),disabled:!0})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Recomendação de Touro"}),a.jsx(t,{value:s.recomendacao_touro,onChange:e=>c({...s,recomendacao_touro:e.target.value}),placeholder:"Recomendação de touro para esta doadora"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Observações"}),a.jsx(ea,{value:s.observacoes,onChange:e=>c({...s,observacoes:e.target.value}),placeholder:"Observações sobre esta aspiração",rows:2})]}),a.jsx(N,{onClick:Za,className:"w-full bg-green-600 hover:bg-green-700",disabled:u||$.length===0,children:u?"Adicionando...":"Adicionar"})]}),a.jsxs(Ia,{value:"new",className:"space-y-4 mt-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Registro *"}),a.jsx(t,{value:f.registro,onChange:e=>R({...f,registro:e.target.value}),placeholder:"Registro da doadora"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Raça *"}),a.jsxs(wa,{value:L,onValueChange:e=>{la(e),R(e==="Outra"?{...f,raca:"",racaCustom:""}:{...f,raca:e,racaCustom:""})},children:[a.jsx(Ea,{children:a.jsx(Sa,{placeholder:"Selecione a raça"})}),a.jsxs(za,{children:[Ba.map(e=>a.jsx(sa,{value:e,children:e},e)),a.jsx(sa,{value:"Outra",children:"Outra"})]})]})]}),L==="Outra"&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Raça Customizada *"}),a.jsx(t,{value:f.racaCustom,onChange:e=>R({...f,racaCustom:e.target.value}),placeholder:"Digite a raça"})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Contagem de Oócitos"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Atrésicos"}),a.jsx(t,{type:"number",min:"0",value:s.atresicos,onChange:e=>c({...s,atresicos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Degenerados"}),a.jsx(t,{type:"number",min:"0",value:s.degenerados,onChange:e=>c({...s,degenerados:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Expandidos"}),a.jsx(t,{type:"number",min:"0",value:s.expandidos,onChange:e=>c({...s,expandidos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Desnudos"}),a.jsx(t,{type:"number",min:"0",value:s.desnudos,onChange:e=>c({...s,desnudos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Viáveis"}),a.jsx(t,{type:"number",min:"0",value:s.viaveis,onChange:e=>c({...s,viaveis:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Total"}),a.jsx(t,{value:z(s),disabled:!0})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Recomendação de Touro"}),a.jsx(t,{value:s.recomendacao_touro,onChange:e=>c({...s,recomendacao_touro:e.target.value}),placeholder:"Recomendação de touro para esta doadora"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Horário de Aspiração"}),a.jsx(t,{type:"time",value:s.horario_aspiracao,onChange:e=>c({...s,horario_aspiracao:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Hora Final *"}),a.jsx(t,{type:"time",value:s.hora_final,onChange:e=>c({...s,hora_final:e.target.value}),required:!0})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Observações"}),a.jsx(ea,{value:s.observacoes,onChange:e=>c({...s,observacoes:e.target.value}),placeholder:"Observações sobre esta aspiração",rows:2})]}),a.jsx(N,{onClick:Ga,className:"w-full bg-green-600 hover:bg-green-700",disabled:u,children:u?"Criando...":"Criar e Adicionar"})]})]})]})]})]})}),a.jsx(ga,{children:a.jsxs(se,{children:[a.jsx(re,{children:a.jsxs(K,{children:[a.jsx(T,{children:"Doadora"}),a.jsx(T,{children:"Registro"}),a.jsx(T,{children:"Horário"}),a.jsx(T,{children:"Viáveis"}),a.jsx(T,{children:"Total Oócitos"}),a.jsx(T,{children:"Recomendação Touro"}),a.jsx(T,{children:"Observações"}),!w&&a.jsx(T,{className:"text-right",children:"Ações"})]})}),a.jsx(oe,{children:C.length===0?a.jsx(K,{children:a.jsx(E,{colSpan:w?7:8,className:"text-center text-slate-500",children:"Nenhuma doadora adicionada à aspiração"})}):C.map(e=>a.jsxs(K,{children:[a.jsx(E,{className:"font-medium",children:e.doadora_nome||"-"}),a.jsx(E,{children:e.doadora_registro||"-"}),a.jsx(E,{children:e.horario_aspiracao?`${e.horario_aspiracao}${e.hora_final?` - ${e.hora_final}`:""}`:"-"}),a.jsx(E,{className:"font-medium",children:e.viaveis||0}),a.jsx(E,{children:e.total_oocitos||0}),a.jsx(E,{children:e.recomendacao_touro||"-"}),a.jsx(E,{children:e.observacoes||"-"}),!w&&a.jsx(E,{className:"text-right",children:a.jsx(N,{variant:"ghost",size:"sm",onClick:()=>Ua(e),children:a.jsx(Fa,{className:"w-4 h-4"})})})]},e.id))})]})})]}),a.jsx(Q,{open:La,onOpenChange:e=>{P(e),e||(H(null),y({horario_aspiracao:"",hora_final:"",atresicos:"",degenerados:"",expandidos:"",desnudos:"",viaveis:"",recomendacao_touro:"",observacoes:""}))},children:a.jsxs(W,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(X,{children:[a.jsxs(Y,{children:["Editar Aspiração - ",(D==null?void 0:D.doadora_nome)||(D==null?void 0:D.doadora_registro)||"Doadora"]}),a.jsx(aa,{children:"Edite os dados da aspiração da doadora"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Horário de Aspiração"}),a.jsx(t,{type:"time",value:n.horario_aspiracao,onChange:e=>y({...n,horario_aspiracao:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Hora Final *"}),a.jsx(t,{type:"time",value:n.hora_final,onChange:e=>y({...n,hora_final:e.target.value}),required:!0})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Contagem de Oócitos"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Atrésicos"}),a.jsx(t,{type:"number",min:"0",value:n.atresicos,onChange:e=>y({...n,atresicos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Degenerados"}),a.jsx(t,{type:"number",min:"0",value:n.degenerados,onChange:e=>y({...n,degenerados:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Expandidos"}),a.jsx(t,{type:"number",min:"0",value:n.expandidos,onChange:e=>y({...n,expandidos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Desnudos"}),a.jsx(t,{type:"number",min:"0",value:n.desnudos,onChange:e=>y({...n,desnudos:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Viáveis"}),a.jsx(t,{type:"number",min:"0",value:n.viaveis,onChange:e=>y({...n,viaveis:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Total"}),a.jsx(t,{value:z(n),disabled:!0})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Recomendação de Touro"}),a.jsx(t,{value:n.recomendacao_touro,onChange:e=>y({...n,recomendacao_touro:e.target.value}),placeholder:"Recomendação de touro para esta doadora"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Observações"}),a.jsx(ea,{value:n.observacoes,onChange:e=>y({...n,observacoes:e.target.value}),placeholder:"Observações sobre esta aspiração",rows:3})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(N,{variant:"outline",onClick:()=>{P(!1),H(null)},disabled:u,children:"Cancelar"}),a.jsx(N,{onClick:Ka,className:"bg-blue-600 hover:bg-blue-700",disabled:u,children:u?"Salvando...":"Salvar Alterações"})]})]})]})}),a.jsx(fa,{open:Ma,onOpenChange:k,children:a.jsxs(_a,{children:[a.jsxs(ba,{children:[a.jsx(Na,{children:"Confirmar Adição de Doadora sem Oócitos"}),a.jsxs(ya,{children:["Esta doadora não possui nenhum oócito (total = 0). Deseja realmente adicioná-la à aspiração?",a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"Atenção:"})," Doadoras sem oócitos podem não ser úteis para o processo de FIV."]})]}),a.jsxs(Ca,{children:[a.jsx(Aa,{disabled:u,children:"Cancelar"}),a.jsx(Da,{onClick:async()=>{k(!1),ca==="add"?await ma():ca==="create"&&await ua(),Z(null)},disabled:u,className:"bg-orange-600 hover:bg-orange-700",children:u?"Adicionando...":"Sim, Adicionar Mesmo Assim"})]})]})}),a.jsx(Q,{open:$a,onOpenChange:V,children:a.jsxs(W,{children:[a.jsxs(X,{children:[a.jsx(Y,{children:"Editar Aspiração"}),a.jsx(aa,{children:"Atualize as informações da aspiração"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Veterinário Responsável *"}),a.jsx(t,{value:S.veterinario_responsavel,onChange:e=>G({...S,veterinario_responsavel:e.target.value}),placeholder:"Nome do veterinário",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(r,{children:"Técnico Responsável *"}),a.jsx(t,{value:S.tecnico_responsavel,onChange:e=>G({...S,tecnico_responsavel:e.target.value}),placeholder:"Nome do técnico",required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(N,{variant:"outline",onClick:()=>V(!1),disabled:u,children:"Cancelar"}),a.jsx(N,{onClick:Qa,className:"bg-blue-600 hover:bg-blue-700",disabled:u,children:u?"Salvando...":"Salvar"})]})]})]})}),a.jsx(fa,{open:Va,onOpenChange:J,children:a.jsxs(_a,{children:[a.jsxs(ba,{children:[a.jsx(Na,{children:"Finalizar Aspiração"}),a.jsxs(ya,{children:["Tem certeza que deseja finalizar esta aspiração? Esta ação não pode ser desfeita.",a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"Atenção:"})," Após finalizar, a aspiração ficará apenas como histórico e não poderá ser editada.",a.jsx("br",{}),a.jsx("br",{}),"Total de oócitos na aspiração: ",a.jsx("strong",{children:q})]})]}),a.jsxs(Ca,{children:[a.jsx(Aa,{disabled:u,children:"Cancelar"}),a.jsx(Da,{onClick:Wa,disabled:u,className:"bg-blue-600 hover:bg-blue-700",children:u?"Finalizando...":"Finalizar Aspiração"})]})]})})]})}export{Ve as default};
