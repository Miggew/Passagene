import{r as i,a as b,s as m,j as e,h as E}from"./index-TMaXuGT-.js";import{C as T,a as v,b as w,d as y}from"./card-DMaHdbj2.js";import{T as N,a as z,b as h,c as r,d as S,e as t}from"./table-BcP2BpwR.js";import{P as _}from"./PageHeader-B9IxJGm-.js";import{E as F}from"./EmptyState-BdHwPhgd.js";import{h as H}from"./error-handler-kJVWyWqE.js";import"./use-toast-BfiUt0Jw.js";function I(){const[o,p]=i.useState([]),[x,d]=i.useState(!0),j=b();i.useEffect(()=>{u()},[]);const u=async()=>{try{d(!0);const{data:a,error:c}=await m.from("fazendas").select("*").order("nome",{ascending:!0});if(c)throw c;const f=[...new Set(a==null?void 0:a.map(s=>s.cliente_id))],{data:n,error:l}=await m.from("clientes").select("id, nome").in("id",f);if(l)throw l;const C=new Map(n==null?void 0:n.map(s=>[s.id,s.nome])),g=a==null?void 0:a.map(s=>({...s,cliente_nome:C.get(s.cliente_id)}));p(g||[])}catch(a){H(a,"Erro ao carregar dados")}finally{d(!1)}};return x?e.jsx(E,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{title:"Fazendas",description:"Gerenciar fazendas do sistema"}),e.jsxs(T,{children:[e.jsx(v,{children:e.jsx(w,{children:"Lista de Fazendas"})}),e.jsx(y,{children:o.length===0?e.jsx(F,{title:"Nenhuma fazenda cadastrada",description:"Cadastre uma fazenda para começar."}):e.jsxs(N,{children:[e.jsx(z,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Nome"}),e.jsx(r,{children:"Cliente"}),e.jsx(r,{children:"Responsável"}),e.jsx(r,{children:"Contato"}),e.jsx(r,{children:"Localização"})]})}),e.jsx(S,{children:o.map(a=>e.jsxs(h,{className:"cursor-pointer hover:bg-muted",onClick:()=>j(`/fazendas/${a.id}`),children:[e.jsx(t,{className:"font-medium text-primary",children:a.nome}),e.jsx(t,{children:a.cliente_nome||"-"}),e.jsx(t,{children:a.responsavel||"-"}),e.jsx(t,{children:a.contato_responsavel||"-"}),e.jsx(t,{children:a.localizacao||"-"})]},a.id))})]})})]})]})}export{I as default};
