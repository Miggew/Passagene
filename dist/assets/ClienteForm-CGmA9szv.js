import{e as v,f as j,r as d,s as m,j as e,a as g,B as f}from"./index-DmNymSE5.js";import{C,a as N,b,d as y}from"./card-SrkIpKk5.js";import{I as u}from"./input-CUsCheD8.js";import{L as h}from"./label-u6KawL_e.js";import{T as E}from"./textarea-BuM8ilf-.js";import{u as w}from"./use-toast-8Wh80yTN.js";import{A as S}from"./arrow-left-4eR3Pk6r.js";function I(){const{id:s}=v(),c=j(),{toast:o}=w(),[n,i]=d.useState(!1),[r,l]=d.useState({nome:"",telefone:"",endereco:""});d.useEffect(()=>{s&&x()},[s]);const x=async()=>{try{i(!0);const{data:a,error:t}=await m.from("clientes").select("*").eq("id",s).single();if(t)throw t;a&&l({nome:a.nome||"",telefone:a.telefone||"",endereco:a.endereco||""})}catch(a){o({title:"Erro ao carregar cliente",description:a instanceof Error?a.message:"Erro desconhecido",variant:"destructive"})}finally{i(!1)}},p=async a=>{if(a.preventDefault(),!r.nome.trim()){o({title:"Erro de validação",description:"Nome é obrigatório",variant:"destructive"});return}try{if(i(!0),s){const{error:t}=await m.from("clientes").update(r).eq("id",s);if(t)throw t;o({title:"Cliente atualizado",description:"Cliente atualizado com sucesso"})}else{const{error:t}=await m.from("clientes").insert([r]);if(t)throw t;o({title:"Cliente criado",description:"Cliente criado com sucesso"})}c("/clientes")}catch(t){o({title:"Erro ao salvar cliente",description:t instanceof Error?t.message:"Erro desconhecido",variant:"destructive"})}finally{i(!1)}};return n&&s?e.jsx(g,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>c("/clientes"),children:e.jsx(S,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:s?"Editar Cliente":"Novo Cliente"}),e.jsx("p",{className:"text-slate-600 mt-1",children:s?"Atualizar informações do cliente":"Cadastrar novo cliente"})]})]}),e.jsxs(C,{children:[e.jsx(N,{children:e.jsx(b,{children:"Informações do Cliente"})}),e.jsx(y,{children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"nome",children:"Nome *"}),e.jsx(u,{id:"nome",value:r.nome,onChange:a=>l({...r,nome:a.target.value}),placeholder:"Nome do cliente",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"telefone",children:"Telefone"}),e.jsx(u,{id:"telefone",value:r.telefone,onChange:a=>l({...r,telefone:a.target.value}),placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"endereco",children:"Endereço"}),e.jsx(E,{id:"endereco",value:r.endereco,onChange:a=>l({...r,endereco:a.target.value}),placeholder:"Endereço completo",rows:3})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(f,{type:"submit",className:"bg-green-600 hover:bg-green-700",disabled:n,children:n?"Salvando...":"Salvar"}),e.jsx(f,{type:"button",variant:"outline",onClick:()=>c("/clientes"),disabled:n,children:"Cancelar"})]})]})})]})]})}export{I as default};
